/*!
 * tui-editor
 * @version 0.12.10
 * @author Sungho Kim <shirenbeat@gmail.com>
 * @license MIT
 */
!function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return e[r].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="dist/",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=n(49),i=r(o);n(40),n(18),n(19),n(34),window.tui=window.tui||{},window.tui.EditorViewOnly=i.default,n(50),$.fn.tuiEditorViewOnly=function(){var e=void 0,t=void 0,n=this[0];if(n){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];if(e=o[0]||{},t=$.data(n,"tuiEditorViewOnly")){if("string"==typeof e){var s;return(s=t)[e].apply(s,a(o.slice(1)))}}else e.el=n,t=new i.default(e),$.data(n,"tuiEditorViewOnly",t)}return this}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(17),l=r(i),s=tui.util,u=/Mac/.test(navigator.platform),c=u?1:0,f=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,e),this._command=new s.Map,this._mdCommand=new s.Map,this._wwCommand=new s.Map,this._options=$.extend({useCommandShortcut:!0},n),this.base=t,this.keyMapCommand={},this._initEvent()}return o(e,[{key:"_addCommandBefore",value:function(e){var t={command:e};return this.base.eventManager.emit("addCommandBefore",t),t.command||e}},{key:"addCommand",value:function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];r.length&&(t=e.command.apply(e,[t].concat(r))),t=this._addCommandBefore(t);var o=t.getName(),i=void 0;return t.isMDType()?i=this._mdCommand:t.isWWType()?i=this._wwCommand:t.isGlobalType()&&(i=this._command),i.set(o,t),t.keyMap&&(this.keyMapCommand[t.keyMap[c]]=o),t}},{key:"_initEvent",value:function(){var e=this;this.base.eventManager.listen("command",function(){e.exec.apply(e,arguments)}),this.base.eventManager.listen("keyMap",function(t){if(e._options.useCommandShortcut){var n=e.keyMapCommand[t.keyMap];n&&(t.data.preventDefault(),e.exec(n))}})}},{key:"exec",value:function(e){var t=void 0,n=void 0,r=this.base;if(t=this._command.get(e),t||(this.base.isMarkdownMode()?(t=this._mdCommand.get(e),r=this.base.mdEditor):(t=this._wwCommand.get(e),r=this.base.wwEditor)),t){for(var a,o=arguments.length,i=Array(o>1?o-1:0),l=1;l<o;l++)i[l-1]=arguments[l];i.unshift(r),n=(a=t).exec.apply(a,i)}return n}}]),e}();f.command=function(e,t){var n=l.default.factory(e,t.name,t.keyMap);return s.extend(n,t),n},e.exports=f},function(e,t){"use strict";var n=/\u200B/g,r=tui.util,a=function(e){return e&&e.nodeType===Node.TEXT_NODE},o=function(e){return e&&e.nodeType===Node.ELEMENT_NODE},i=function(e){return o(e)?e.tagName:"TEXT"},l=function(e){var t=void 0;return o(e)?t=e.textContent.replace(n,"").length:a(e)&&(t=e.nodeValue.replace(n,"").length),t},s=function(e){var t=void 0;return o(e)?t=e.childNodes.length:a(e)&&(t=e.nodeValue.replace(n,"").length),t},u=function(e){var t=e.parentNode.childNodes,n=void 0,r=void 0,a=void 0;for(n=0,r=t.length;n<r;n+=1)if(t[n]===e){a=n;break}return a},c=function(e,t){var n=void 0;return a(e)?n=e:e.childNodes.length&&t>=0&&(n=e.childNodes[t]),n},f=function(e,t,n){for(var r=e+"Sibling",a=void 0,o=void 0;t&&!t[r]&&(a=i(t.parentNode),a!==n&&"BODY"!==a);)t=t.parentNode;return t[r]&&(o=t[r]),o},d=function(e,t,n){var r=void 0;return r=t>0?c(e,t-1):f("previous",e,n)},h=function(e,t){for(var n=void 0;e.parentNode&&!t(e.parentNode);)e=e.parentNode;return t(e.parentNode)&&(n=e),n},g=function(e,t){var n=void 0;return n=r.isString(t)?h(e,function(e){return t===i(e)}):h(e,function(e){return t===e})},p=function(e,t,n){var r=e+"Sibling",a=void 0;return t=g(t,n),t&&t[r]&&(a=t[r]),a},v=function(e,t){return p("previous",e,t)},m=function(e,t){return p("next",e,t)},b=function(e){return g(e,"BODY")},y=function(e){for(e=e.previousSibling||e.parentNode;!a(e)&&"BODY"!==i(e);)if(e.previousSibling)for(e=e.previousSibling;e.lastChild;)e=e.lastChild;else e=e.parentNode;return"BODY"===i(e)&&(e=null),e},w=function(e,t,n){var a=[],o="",i=0,l=void 0;if(!t.length)return a;for(var s=t.shift(),u=document.createTreeWalker(e,4,null,!1);u.nextNode();){for(o=u.currentNode.nodeValue||"",n&&(o=n(o)),l=i+o.length;l>=s;){if(a.push({container:u.currentNode,offsetInContainer:s-i,offset:s}),!t.length)return a;s=t.shift()}i=l}do a.push({container:u.currentNode,offsetInContainer:o.length,offset:s}),s=t.shift();while(!r.isUndefined(s));return a},_=function(e){var t={};t.tagName=e.nodeName,e.id&&(t.id=e.id);var n=e.className.trim();return n&&(t.className=n),t},k=function(e,t){for(var n=[];e&&e!==t;)o(e)&&n.unshift(_(e)),e=e.parentNode;return n},x=function(e,t){var n=!0,r=null;return tui.util.isUndefined(t)||"next"!==t&&"previous"!==t?null:("previous"===t&&(n=!1),r=n?e.nextElementSibling:e.previousElementSibling)},C=function(e,t,n){var r=!0,a=null,o=void 0,l=void 0,s=void 0,c=void 0,f=void 0,d=void 0;return tui.util.isUndefined(t)||"next"!==t&&"previous"!==t?null:("previous"===t&&(r=!1),e?(o=$(e),r?(s=o.parent().next(),c=o.parents("thead"),f=c[0]&&c.next(),d=f&&"TBODY"===i(f[0]),l=0):(s=o.parent().prev(),c=o.parents("tbody"),f=c[0]&&c.prev(),d=f&&"THEAD"===i(f[0]),l=e.parentNode.childNodes.length-1),!tui.util.isUndefined(n)&&n||(l=u(e)),s[0]?a=s.children("td,th")[l]:c[0]&&d&&(a=f.find("td,th")[l]),a):null)};e.exports={getNodeName:i,isTextNode:a,isElemNode:o,getTextLength:l,getOffsetLength:s,getPrevOffsetNodeUntil:d,getNodeOffsetOfParent:u,getChildNodeByOffset:c,getTopPrevNodeUnder:v,getTopNextNodeUnder:m,getParentUntil:g,getTopBlockNode:b,getPrevTextNode:y,findOffsetNode:w,getPath:k,getNodeInfo:_,getTableCellByDirection:x,getSiblingRowCellByDirection:C}},function(e,t){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t,n){var r=$(e),a=r.attr("colspan"),o=r.attr("rowspan"),i=e.nodeName;if("TH"!==i&&"TD"!==i)return null;var l={nodeName:e.nodeName,colspan:a?parseInt(a,10):1,rowspan:o?parseInt(o,10):1,content:r.html(),elementIndex:{rowIndex:t,colIndex:n}};return"TH"===e.nodeName&&e.align&&(l.align=e.align),l}function a(e,t,n,r){var a=t.colspan,o=t.rowspan,i=a>1,l=o>1,s=t.nodeName;if(i||l){var u=n+o,c=r+a;b.range(n,u).forEach(function(t){e[t]=e[t]||[],b.range(r,c).forEach(function(a){var o={nodeName:s};t===n&&a===r||(i&&(o.colMergeWith=r),l&&(o.rowMergeWith=n),e[t][a]=o)})})}}function o(e){var t=[];return e.find("tr").each(function(e,n){var o=0;t[e]=t[e]||[],$(n).children().each(function(n,i){var l=r(i,e,n);if(l){for(var s=n+o;t[e][s];)s+=1,o+=1;t[e][s]=l,a(t,l,e,s)}})}),e[0].className&&(t.className=e[0].className),t}function i(e){var t=[];return e.forEach(function(e,n){var r=[];e.forEach(function(e,t){b.isUndefined(e.colMergeWith)&&b.isUndefined(e.rowMergeWith)&&r.push({rowIndex:n,colIndex:t})}),t.push(r)}),t}function l(e){var t=e[0];return t.map(function(e){var n=void 0;return n=b.isExisty(e.colMergeWith)?t[e.colMergeWith].align:e.align})}function s(e,t){var n=l(e),r=t.map(function(t){return t.map(function(t){var r=t.rowIndex,a=t.colIndex;return b.extend({align:n[a]},e[r][a])})});return e.className&&(r.className=e.className),r}function u(e,t,n){return{nodeName:n||"TD",colspan:1,rowspan:1,content:y,elementIndex:{rowIndex:e,colIndex:t}}}function c(e){var t=e.closest("tr"),n=t.prevAll().length;return"TBODY"===t.parent()[0].nodeName&&(n+=1),n}function f(e){return e.closest("td, th").prevAll().length}function d(e,t){var n=c(t),r=f(t);return e[n][r]}function h(e,t,n){var r=e[t][n],a=t;return r.rowspan>1&&(a+=r.rowspan-1),a}function g(e,t,n){var r=e[t][n],a=n;return r.colspan>1&&(a+=r.colspan-1),a}function p(e,t,n){var r=e[t][n];return t=b.isExisty(r.rowMergeWith)?r.rowMergeWith:t,n=b.isExisty(r.colMergeWith)?r.colMergeWith:n,e[t][n].elementIndex}function v(e,t){e.forEach(function(e,n){var r=e.length,a=e[0].nodeName;b.range(r,t).forEach(function(t){e.push(u(n,t,a))})})}function m(e){var t=e[0],r=t.length,a=!0;if(!r&&e[1])b.range(0,e[1].length).forEach(function(e){t.push(u(0,e,"TH"))});else if("TH"!==e[0][0].nodeName){var o,i=b.range(0,r).map(function(e){return u(0,e,"TH")});(o=[]).concat.apply(o,n(e)).forEach(function(e){e.elementIndex&&(e.elementIndex.rowIndex+=1)}),e.unshift(i)}else if(1===e.length){var l=b.range(0,r).map(function(e){return u(1,e,"TD")});e.push(l)}else a=!1;return a}Object.defineProperty(t,"__esModule",{value:!0}),t.createTableData=o,t.createCellIndexData=i;var b=tui.util,y=tui.util.browser.msie?"":"<br>";t.default={createTableData:o,createCellIndexData:i,createRenderData:s,findElementRowIndex:c,findElementColIndex:f,findCellIndex:d,createBasicCell:u,findRowMergedLastIndex:h,findColMergedLastIndex:g,findElementIndex:p,stuffCellsIntoIncompleteRow:v,addTbodyOrTheadIfNeed:m}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){var r=f.default.createCellIndexData(e),a=f.default.findCellIndex(r,t),o=f.default.findCellIndex(r,n),i=void 0,l=void 0,s=void 0,u=void 0;return a.rowIndex>o.rowIndex?(i=o.rowIndex,l=a.rowIndex):(i=a.rowIndex,l=o.rowIndex),a.colIndex>o.colIndex?(s=o.colIndex,u=a.colIndex):(s=a.colIndex,u=o.colIndex),{start:{rowIndex:i,colIndex:s},end:{rowIndex:l,colIndex:u}}}function o(e,t,n){var r=t[n].rowIndex,a=e[r];d.range(t.start.colIndex,t.end.colIndex+1).forEach(function(n){var o=a[n],i=o.rowMergeWith,l=-1;d.isExisty(i)?(i<t.start.rowIndex&&(t.start.rowIndex=i),l=i+e[i][n].rowspan-1):o.rowspan>1&&(l=r+o.rowspan-1),l>t.end.rowIndex&&(t.end.rowIndex=l)})}function i(e,t,n,r){var a=e[n],o=a[r],i=o.colMergeWith,l=-1;d.isExisty(i)?(i<t.start.colIndex&&(t.start.colIndex=i),l=i+a[i].colspan-1):o.colspan>1&&(l=r+o.colspan-1),l>t.end.colIndex&&(t.end.colIndex=l)}function l(e,t){for(var n="";n!==JSON.stringify(t);)n=JSON.stringify(t),o(e,t,"start"),o(e,t,"end"),d.range(t.start.rowIndex,t.end.rowIndex+1).forEach(function(n){i(e,t,n,t.start.colIndex),i(e,t,n,t.end.colIndex)});return t}function s(e,t,n){var r=a(e,t,n);return l(e,r)}function u(e,t,n){var r=f.default.createCellIndexData(e),a={};if(t.length){var o=f.default.findCellIndex(r,t.first()),i=d.extend({},o);t.each(function(t,n){var a=f.default.findCellIndex(r,$(n)),o=e[a.rowIndex][a.colIndex],l=a.rowIndex+o.rowspan-1,s=a.colIndex+o.colspan-1;i.rowIndex=Math.max(i.rowIndex,l),i.colIndex=Math.max(i.colIndex,s)}),a.start=o,a.end=i}else{var l=f.default.findCellIndex(r,n);a.start=l,a.end=d.extend({},l)}return a}Object.defineProperty(t,"__esModule",{value:!0});var c=n(3),f=r(c),d=tui.util;t.default={findSelectionRange:s,getTableSelectionRange:u}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=e.colspan>1?' colspan="'+e.colspan+'"':"";return t+=e.rowspan>1?' rowspan="'+e.rowspan+'"':"",t+=e.align?' align="'+e.align+'"':"","<"+e.nodeName+t+">"+e.content+"</"+e.nodeName+">"}function o(e,t){var n="";return e.length&&(n=e.map(function(e){var t=e.map(a).join("");return"<tr>"+t+"</tr>"}).join(""),n="<"+t+">"+n+"</"+t+">"),n}function i(e){var t=[e[0]],n=e.slice(1),r=o(t,"THEAD"),a=o(n,"TBODY"),i=e.className?' class="'+e.className+'"':"";return"<table"+i+">"+(r+a)+"</renderData>"}function l(e,t){var n=c.default.createCellIndexData(t),r=c.default.createRenderData(t,n),a=$(i(r));return e.replaceWith(a),a}function s(e,t,n){t.selectNodeContents(n),t.collapse(!0),e.setSelection(t)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(3),c=r(u);t.default={createTableHtml:i,replaceTable:l,focusToCell:s}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=tui.util,o=void 0,i="en_US",l=function(){function e(){n(this,e),this._code=i,this._langs=new a.Map}return r(e,[{key:"setCode",value:function(e){this._code=e}},{key:"setLang",value:function(e,t){var n=this;e=[].concat(e),e.forEach(function(e){if(n._langs.has(e)){var r=n._langs.get(e);n._langs.set(e,a.extend(r,t))}else n._langs.set(e,t)})}},{key:"get",value:function(e,t){t||(t=this._code);var n=this._langs.get(t);n||(n=this._langs.get(i));var r=n[e];if(!r)throw new Error('There is no text key "'+e+'" in '+t);return r}}],[{key:"getSharedInstance",value:function(){return o||(o=new e),o}}]),e}();t.I18n=l,t.default=l.getSharedInstance()},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=tui.util,o=function(){function e(){n(this,e),this.exts=new a.Map}return r(e,[{key:"defineExtension",value:function(e,t){this.exts.set(e,t)}},{key:"applyExtension",value:function(e,t){var n=this;t&&t.forEach(function(t){n.exts.has(t)&&n.exts.get(t)(e)})}}]),e}();e.exports=new o},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=tui.util,i=window.hljs,l="tui-editor-custom-code-block",s=void 0,u=function(){function e(){n(this,e),this._elementReplacer=new o.Map}return a(e,[{key:"setElementReplacer",value:function(e,t){this._elementReplacer.set(e,t)}},{key:"createCodeBlockHtml",value:function(e,t){var n=this._elementReplacer.get(e),a=l,o=void 0;return n?(t=encodeURIComponent(t).replace(/(%0A)+$/,""),o='<pre class="'+a+'" data-language="'+e+'" data-code-text="'+t+'">'+e+"</pre>"):o=i.getLanguage(e)?i.highlight(e,t).value:r(t,!1),o}},{key:"_getViewMode",value:function(e,t){var n=void 0;return n=e?"viewOnly":t?"wysiwyg":"preview"}},{key:"_replaceElement",value:function(e,t,n,r){var a=$(t),o=a.data("language"),i=t.parentNode,s=a.data("code-text"),u=$(n({id:r,containerElement:e,codeBlockElement:t,type:o,codeText:decodeURIComponent(s)}));u.length?(t!==u[0]&&i===t.parentNode&&a.replaceWith(u),u[0].id=r,u.data("language",o),u.addClass(l),tui.util.isEmpty(u.data("code-text"))&&u.data("code-text",s)):t.id=r}},{key:"replaceElements",value:function(e,t,n){var r=this,a=e.find("."+l),o=e[0],i=this._getViewMode(t,n),s=$.proxy(this._replaceElement,this),u=(new Date).getTime();a.each(function(e,t){var n=l+"-"+u+"-"+e,a=r._elementReplacer.get($(t).data("language")),c=a?a[i]:null;c?s(o,t,c,n):t.id=n})}},{key:"_restoreElement",value:function(e){var t=$(e),n=t.data("language"),a=decodeURIComponent(t.data("code-text")),o=$('<pre data-language="'+n+'" class="lang-'+n+'"></pre>');a&&o.html("<div>"+r(a,!1).replace(/\n/g,"<br>")+"</div>"),t.replaceWith(o)}},{key:"restoreElements",value:function(e){var t=e.find("."+l),n=$.proxy(this._restoreElement,this);t.each(function(e,t){n(t)})}},{key:"updateCodeTextById",value:function(e,t,n){var r=$(e).find("#"+t);r.data("code-text",encodeURIComponent(n))}}],[{key:"getSharedInstance",value:function(){return s||(s=new e),s}}]),e}();t.CodeBlockManager=u,t.default=u.getSharedInstance()},,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(13),l=r(i),s=n(47),u=r(s),c=n(43),f=r(c),d=n(44),h=r(d),g=n(42),p=r(g),v=n(46),m=r(v),b=n(45),y=r(b),w=n(8),_=r(w),k=window.markdownit,x=window.toMark,C=k({html:!0,breaks:!0,quotes:"“”‘’",langPrefix:"lang-",highlight:function(e,t){return _.default.createCodeBlockHtml(t,e)}}),T=k({html:!0,breaks:!0,quotes:"“”‘’",langPrefix:"lang-"});C.block.ruler.at("table",m.default,["paragraph","reference"]),C.block.ruler.at("code",h.default),C.block.ruler.at("blockquote",p.default,["paragraph","reference","list"]),C.block.ruler.at("html_block",y.default,["paragraph","reference","blockquote"]),C.use(u.default),C.use(f.default),T.block.ruler.at("table",m.default,["paragraph","reference"]),T.block.ruler.at("code",h.default),T.block.ruler.at("blockquote",p.default,["paragraph","reference","list"]),T.block.ruler.at("html_block",y.default,["paragraph","reference","blockquote"]),T.use(u.default),T.use(f.default);var M=function(){function e(t){a(this,e),this.eventManager=t}return o(e,[{key:"_markdownToHtmlWithCodeHighlight",value:function(e){e=e.replace(/<br>/gi,"<br data-tomark-pass>");for(var t=/(<img[^>]*)(onerror\s*=\s*[\"']?[^\"']*[\"']?)(.*)/i;t.exec(e);)e=e.replace(t,"$1$3");var n=C.render(e);return n=this._removeBrToMarkPassAttributeInCode(n)}},{key:"_markdownToHtml",value:function(e){e=e.replace(/<br>/gi,"<br data-tomark-pass>");for(var t=/(<img[^>]*)(onerror\s*=\s*[\"']?[^\"']*[\"']?)(.*)/i;t.exec(e);)e=e.replace(t,"$1$3");var n=T.render(e);return n=this._removeBrToMarkPassAttributeInCode(n)}},{key:"_removeBrToMarkPassAttributeInCode",value:function(e){var t=$("<div />");return t.html(e),t.find("code, pre").each(function(e,t){var n=$(t);n.html(n.html().replace(/&lt;br data-tomark-pass&gt;/,"&lt;br&gt;"))}),e=t.html()}},{key:"toHTMLWithCodeHightlight",value:function(e){var t=this._markdownToHtmlWithCodeHighlight(e);return t=this.eventManager.emitReduce("convertorAfterMarkdownToHtmlConverted",t)}},{key:"toHTML",value:function(e){var t=this._markdownToHtml(e);return t=this.eventManager.emitReduce("convertorAfterMarkdownToHtmlConverted",t)}},{key:"initHtmlSanitizer",value:function(){this.eventManager.listen("convertorAfterMarkdownToHtmlConverted",function(e){return(0,l.default)(e,!0)})}},{key:"toMarkdown",value:function(e,t){var n=[];e=this.eventManager.emitReduce("convertorBeforeHtmlToMarkdownConverted",e);var r=x(this._appendAttributeForBrIfNeed(e),t);return r=this.eventManager.emitReduce("convertorAfterHtmlToMarkdownConverted",r),tui.util.forEach(r.split("\n"),function(e,t){var r=/^\|[^|]*\|/gi,a=/`[^`]*<br>[^`]*`/gi;a.test(e)||r.test(e)||(e=e.replace(/<br>/gi,"<br>\n")),n[t]=e}),n.join("\n")}},{key:"_appendAttributeForBrIfNeed",value:function(e){var t=/<br>/gi,n=/<br \/><br \/>/gi,r=/<br data-tomark-pass \/><br \/>(.)/gi,a=/([^>]|<\/b>|<\/i>|<\/s>|<img [^>]*>)/,o=/<br data-tomark-pass \/><br data-tomark-pass \/>/,i=new RegExp(a.source+o.source,"g");e=e.replace(t,"<br />"),e=e.replace(n,"<br data-tomark-pass /><br data-tomark-pass />");var l=document.createElement("div"),s=$(l);return s.html(e),s.find("pre br,code br").each(function(e,t){t.hasAttribute("data-tomark-pass")&&t.removeAttribute("data-tomark-pass")}),e=s.html().replace(/<br data-tomark-pass="">/gi,"<br data-tomark-pass />"),e=e.replace(t,"<br />"),e=e.replace(r,"<br data-tomark-pass /><br data-tomark-pass />$1"),e=e.replace(i,"$1<br /><br />")}}],[{key:"factory",value:function(t){return new e(t)}},{key:"getMarkdownHighlightRenderer",value:function(){return C}}]),e}();e.exports=M},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=tui.util,o=["previewBeforeHook","previewRenderAfter","previewNeedsRefresh","addImageBlobHook","setMarkdownAfter","contentChangedFromWysiwyg","changeFromWysiwyg","contentChangedFromMarkdown","changeFromMarkdown","change","changeModeToWysiwyg","changeModeToMarkdown","changeModeBefore","changeMode","changePreviewStyle","openPopupAddLink","openPopupAddImage","openPopupAddTable","openPopupTableUtils","openHeadingSelect","closeAllPopup","command","addCommandBefore","htmlUpdate","markdownUpdate","renderedHtmlUpdated","removeEditor","convertorAfterMarkdownToHtmlConverted","convertorBeforeHtmlToMarkdownConverted","convertorAfterHtmlToMarkdownConverted","stateChange","wysiwygSetValueAfter","wysiwygSetValueBefore","wysiwygGetValueBefore","wysiwygProcessHTMLText","wysiwygRangeChangeAfter","wysiwygKeyEvent","replaceCodeBlockElementsBefore","pasteBefore","scroll","click","mousedown","mouseover","mouseup","contextmenu","keydown","keyup","keyMap","load","focus","blur","paste","copy","copyBefore","copyAfter","cut","cutAfter","drop","show","hide"],i=function(){function e(){n(this,e),this.events=new a.Map,this.TYPE=new a.Enum(o)}return r(e,[{key:"listen",value:function(e,t){var n=this._getTypeInfo(e),r=this.events.get(n.type)||[];if(!this._hasEventType(n.type))throw new Error("There is no event type "+n.type);n.namespace&&(t.namespace=n.namespace),r.push(t),this.events.set(n.type,r)}},{key:"emit",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.shift(),o=this._getTypeInfo(r),i=this.events.get(o.type),l=void 0;return i&&a.forEach(i,function(e){var n=e.apply(void 0,t);a.isUndefined(n)||(l=l||[],l.push(n))}),l}},{key:"emitReduce",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.shift(),o=this.events.get(r);return o&&a.forEach(o,function(e){var n=e.apply(void 0,t);a.isFalsy(n)||(t[0]=n)}),t[0]}},{key:"_getTypeInfo",value:function(e){var t=e.split(".");return{type:t[0],namespace:t[1]}}},{key:"_hasEventType",value:function(e){return!a.isUndefined(this.TYPE[this._getTypeInfo(e).type])}},{key:"addEventType",value:function(e){if(this._hasEventType(e))throw new Error("There is already have event type "+e);this.TYPE.set(e)}},{key:"removeEventHandler",value:function(e){var t=this,n=this._getTypeInfo(e),r=n.type,a=n.namespace;r&&!a?this.events.delete(r):!r&&a?this.events.forEach(function(e,n){t._removeEventHandlerWithTypeInfo(n,a)}):r&&a&&this._removeEventHandlerWithTypeInfo(r,a)}},{key:"_removeEventHandlerWithTypeInfo",value:function(e,t){var n=[],r=this.events.get(e);r&&(r.map(function(e){e.namespace!==t&&n.push(e)}),this.events.set(e,n))}}]),e}();e.exports=i},function(e,t){"use strict";function n(e,t){var n=$("<div />");return e=e.replace(/<!--[\s\S]*?-->/g,""),n.append(e),r(n),a(n),o(n,t)}function r(e){e.find("script, iframe, textarea, form, button, select, meta, style, link, title").remove()}function a(e){e.find("*").each(function(e,t){var n=i.toArray(t.attributes).filter(function(e){var t=e.name.match(l),n=e.name.match(s);return!t&&!n});i.forEachArray(n,function(e){t.attributes.removeNamedItem(e.name)})})}function o(e,t){var n=void 0;if(t)n=e[0].innerHTML;else{for(var r=document.createDocumentFragment(),a=tui.util.toArray(e[0].childNodes),o=a.length,i=0;i<o;i+=1)r.appendChild(a[i]);n=r}return n}var i=tui.util,l=new RegExp("^(abbr|align|alt|axis|bgcolor|border|cellpadding|cellspacing|class|clear|color|cols|compact|coords|dir|face|headers|height|hreflang|hspace|ismap|lang|language|nohref|nowrap|rel|rev|rows|rules|scope|scrolling|shape|size|span|start|summary|tabindex|target|title|type|valign|value|vspace|width|checked|mathvariant|encoding|id|name|background|cite|href|longdesc|src|usemap|xlink:href|data-+|checked|style)","g"),s=new RegExp("^(accent-height|accumulate|additive|alphabetic|arabic-form|ascent|baseProfile|bbox|begin|by|calcMode|cap-height|class|color|color-rendering|content|cx|cy|d|dx|dy|descent|display|dur|end|fill|fill-rule|font-family|font-size|font-stretch|font-style|font-variant|font-weight|from|fx|fy|g1|g2|glyph-name|gradientUnits|hanging|height|horiz-adv-x|horiz-origin-x|ideographic|k|keyPoints|keySplines|keyTimes|lang|marker-end|marker-mid|marker-start|markerHeight|markerUnits|markerWidth|mathematical|max|min|offset|opacity|orient|origin|overline-position|overline-thickness|panose-1|path|pathLength|points|preserveAspectRatio|r|refX|refY|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|rotate|rx|ry|slope|stemh|stemv|stop-color|stop-opacity|strikethrough-position|strikethrough-thickness|stroke|stroke-dasharray|stroke-dashoffset|stroke-linecap|stroke-linejoin|stroke-miterlimit|stroke-opacity|stroke-width|systemLanguage|target|text-anchor|to|transform|type|u1|u2|underline-position|underline-thickness|unicode|unicode-range|units-per-em|values|version|viewBox|visibility|width|widths|x|x-height|x1|x2|xlink:actuate|xlink:arcrole|xlink:role|xlink:show|xlink:title|xlink:type|xml:base|xml:lang|xml:space|xmlns|xmlns:xlink|y|y1|y2|zoomAndPan)","g");e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(41),l=r(i),s=n(8),u=r(s),c=function(){function e(t,n,r,o){a(this,e),this.eventManager=n,this.convertor=r,this.$el=t,this.isViewOnly=!!o,this._initContentSection(),this.lazyRunner=new l.default,this.lazyRunner.registerLazyRunFunction("refresh",this.refresh,800,this),this._initEvent()}return o(e,[{key:"_initEvent",value:function(){var e=this,t="";this.eventManager.listen("contentChangedFromMarkdown",function(n){t=n.getValue(),e.isVisible()&&e.lazyRunner.run("refresh",n.getValue().replace(/<br>\n/g,"<br>"))}),this.eventManager.listen("previewNeedsRefresh",function(n){e.refresh(n||t)}),this.$el.on("scroll",function(t){e.eventManager.emit("scroll",{source:"preview",data:t})})}},{key:"_initContentSection",value:function(){this.$previewContent=$('<div class="tui-editor-contents" />'),this.$el.append(this.$previewContent)}},{key:"refresh",value:function(e){this.render(this.convertor.toHTMLWithCodeHightlight(e))}},{key:"render",value:function(e){var t=e,n=this.eventManager.emit("previewBeforeHook",e);n&&(t=n[0]),this.$previewContent.empty(),this.$previewContent.html(t),this.eventManager.emit("replaceCodeBlockElementsBefore"),u.default.replaceElements(this.$previewContent,this.isViewOnly),this.eventManager.emit("previewRenderAfter",this)}},{key:"setHeight",value:function(e){this.$el.height(e)}},{key:"isVisible",value:function(){return"none"!==this.$el.css("display")}}]),e}();e.exports=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n="<br />",r="<"+t+">"+n+"</"+t+">",a="",o=0;o<e;o+=1)a+=r;return a}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(2),s=r(l),u=tui.util,c=u.browser.msie&&10===u.browser.version,f="te-content-table-",d=u.browser.msie&&(10===u.browser.version||11===u.browser.version),h=u.browser.msie?"":"<br>",g="te-cell-selected",p=function(){function e(t){a(this,e),this.wwe=t,this.eventManager=t.eventManager,this.name="table",this._lastCellNode=null,this._init()}return i(e,[{key:"_init",value:function(){this._initKeyHandler(),this._initEvent(),this.tableID=0}},{key:"_initEvent",value:function(){var e=this;this.eventManager.listen("wysiwygRangeChangeAfter.table",function(){var t=e.wwe.getEditor().getSelection(),n=e.isInTable(t);if(e._unwrapBlockInTable(),e._completeTableIfNeed(),!n){var r=e.wwe.componentManager.getManager("tableSelection");r.removeClassAttrbuteFromAllCellsIfNeed()}e._insertDefaultBlockBetweenTable()}),this.eventManager.listen("wysiwygSetValueAfter.table",function(){e._unwrapBlockInTable(),e._insertDefaultBlockBetweenTable()}),this.eventManager.listen("wysiwygProcessHTMLText.table",function(e){return e.replace(/<br \/>(<\/td>|<\/th>)/g,"$1")}),this.eventManager.listen("cut.table",function(){var t=e.wwe.componentManager.getManager("tableSelection"),n=t.getSelectedCells();n.length&&n.get().forEach(function(e){return $(e).html(h)}),t.removeClassAttrbuteFromAllCellsIfNeed()}),this.eventManager.listen("copyBefore.table",function(t){var n=t.$clipboardContainer;return e.updateTableHtmlOfClipboardIfNeed(n)}),this.onBindedPaste=this._onPaste.bind(this),this.wwe.getEditor().addEventListener("paste",this.onBindedPaste)}},{key:"updateTableHtmlOfClipboardIfNeed",value:function(e){var t=this,n=this.wwe.componentManager.getManager("tableSelection"),r=n.getSelectedCells();if(r.length){n.createRangeBySelectedCells();var a=this.wwe.getEditor().getSelection().cloneContents();$(a).children().each(function(e,n){var r=$(n);t.isTableOrSubTableElement(n.nodeName)&&("TABLE"===n.nodeName&&0===r.find("thead").length&&0===r.find("tbody").length?r.remove():n.previousSibling&&"TABLE"===n.previousSibling.nodeName?n.previousSibling.appendChild(n):(t._completeIncompleteTable(n),"TABLE"!==n.nodeName&&"THEAD"!==n.nodeName&&$(n).closest("table").find("thead").remove()))}),e.append(a),e.find("."+g).removeClass(g)}}},{key:"pasteClipboardData",value:function(e){this.wwe.componentManager.getManager("tableSelection").getSelectedCells().length||(this._expandTableIfNeed(e),this._pasteDataIntoTable(e))}},{key:"_onPaste",value:function(e){var t=this.wwe.getEditor().getSelection(),n=!s.default.isTextNode(t.commonAncestorContainer);this.isInTable(t)&&!t.collapsed&&n&&e.preventDefault()}},{key:"_initKeyHandler",value:function(){var e=this;this.keyEventHandlers={DEFAULT:function(t,n,r){var a=e.isInTable(n);a&&!e._isSingleModifierKey(r)?(e._recordUndoStateIfNeed(n),e._removeBRIfNeed(n),e._removeContentsAndChangeSelectionIfNeed(n,r,t)):!a&&e._lastCellNode&&e._recordUndoStateAndResetCellNode(n),a&&!e._isModifierKeyPushed(t)&&e.wwe.getEditor().modifyDocument(function(){var t=e.wwe.componentManager.getManager("tableSelection");t.removeClassAttrbuteFromAllCellsIfNeed()})},ENTER:function(t,n){var r=void 0;return e._isAfterTable(n)?(t.preventDefault(),n.setStart(n.startContainer,n.startOffset-1),e.wwe.breakToNewDefaultBlock(n),r=!1):e._isBeforeTable(n)?(t.preventDefault(),e.wwe.breakToNewDefaultBlock(n,"before"),r=!1):e.isInTable(n)&&(e._appendBrIfTdOrThNotHaveAsLastChild(n),r=!1),r},BACK_SPACE:function(t,n,r){return e._handleBackspaceAndDeleteKeyEvent(t,n,r)},DELETE:function(t,n,r){return e._handleBackspaceAndDeleteKeyEvent(t,n,r)},TAB:function(){return e._moveCursorTo("next","cell")},"SHIFT+TAB":function(t){return e._moveCursorTo("previous","cell",t)},UP:function(t){return e._moveCursorTo("previous","row",t)},DOWN:function(t){return e._moveCursorTo("next","row",t)}},u.forEach(this.keyEventHandlers,function(t,n){return e.wwe.addKeyEventHandler(n,t)})}},{key:"isInTable",value:function(e){var t=void 0,n=void 0;return e.collapsed?(t=e.startContainer,n=!!$(t).closest("table").length):(t=e.commonAncestorContainer,n=!!$(t).closest("table").length||!!$(e.cloneContents()).find("table").length),n}},{key:"_isBeforeTable",value:function(e){return"TABLE"===s.default.getNodeName(s.default.getChildNodeByOffset(e.startContainer,e.startOffset))}},{key:"_isAfterTable",value:function(e){var t=s.default.getPrevOffsetNodeUntil(e.startContainer,e.startOffset);
return"TABLE"===s.default.getNodeName(t)&&e.commonAncestorContainer===this.wwe.get$Body()[0]}},{key:"_handleBackspaceAndDeleteKeyEvent",value:function(e,t,n){var r="BACK_SPACE"===n,a=3!==t.commonAncestorContainer.nodeType&&t.commonAncestorContainer!==this.wwe.get$Body()[0],o=void 0;if(t.collapsed){if(this.isInTable(t))r?this._tableHandlerOnBackspace(t,e):this._tableHandlerOnDelete(t,e),this._insertBRIfNeed(t),this._removeContentsAndChangeSelectionIfNeed(t,n,e),o=!1;else if(!r&&this._isBeforeTable(t)||r&&this._isAfterTable(t)){e.preventDefault();var i=r?t.startOffset-1:t.startOffset;this._removeTable(t,s.default.getChildNodeByOffset(t.startContainer,i)),o=!1}}else this.isInTable(t)&&a&&(e.preventDefault(),this._removeContentsAndChangeSelectionIfNeed(t,n,e),o=!1);return o}},{key:"_tableHandlerOnBackspace",value:function(e,t){var n=s.default.getPrevOffsetNodeUntil(e.startContainer,e.startOffset,"TR"),r=s.default.getNodeName(n);n&&"TD"!==r&&"TH"!==r?"BR"===r&&1!==n.parentNode.childNodes.length&&(t.preventDefault(),$(n).remove()):t.preventDefault()}},{key:"isNonTextDeleting",value:function(e){var t=e.startContainer,n=t.nextSibling,r=s.default.getNodeName(n),a=s.default.getNodeName(t),o=a===r&&"TEXT"!==a,i=(!n||"BR"===r&&n.parentNode.lastChild===n)&&s.default.isTextNode(t)&&e.startOffset===t.nodeValue.length,l=!i&&$(t).parents("tr").children().last()[0]===t&&("TD"===a||"TH"===a);return o||i||l}},{key:"_tableHandlerOnDelete",value:function(e,t){var n=this.isNonTextDeleting(e);n&&(t.preventDefault(),e.startContainer.normalize())}},{key:"_appendBrIfTdOrThNotHaveAsLastChild",value:function(e){var t=s.default.getNodeName(e.startContainer),n=void 0;if("TD"===t||"TH"===t)n=e.startContainer;else{var r=$(e.startContainer).parentsUntil("tr");n=r[r.length-1]}"BR"===s.default.getNodeName(n.lastChild)||"DIV"===s.default.getNodeName(n.lastChild)||d||$(n).append($("<br />")[0])}},{key:"_unwrapBlockInTable",value:function(){this.wwe.get$Body().find("td div,th div,tr>br,td>br,th>br").each(function(e,t){if("BR"===s.default.getNodeName(t)){var n=s.default.getNodeName(t.parentNode),r=/TD|TH/.test(n),a=0===t.parentNode.textContent.length,o=t.parentNode.lastChild===t;("TR"===n||r&&!a&&o)&&$(t).remove()}else $(t).children().unwrap()})}},{key:"_insertDefaultBlockBetweenTable",value:function(){this.wwe.get$Body().find("table").each(function(e,t){t.nextElementSibling&&"TABLE"===t.nextElementSibling.nodeName&&$("<div><br /></div>").insertAfter(t)})}},{key:"_removeTable",value:function(e,t){"TABLE"===t.tagName&&(this.wwe.getEditor().saveUndoState(e),this.wwe.saveSelection(e),$(t).remove(),this.wwe.restoreSavedSelection())}},{key:"_recordUndoStateIfNeed",value:function(e){var t=s.default.getParentUntil(e.startContainer,"TR");e.collapsed&&t&&this._lastCellNode!==t&&(this.wwe.getEditor().saveUndoState(e),this._lastCellNode=t)}},{key:"_recordUndoStateAndResetCellNode",value:function(e){this.wwe.getEditor().saveUndoState(e),this.resetLastCellNode()}},{key:"_pasteDataIntoTable",value:function(e){var t=this.wwe.getEditor().getSelection(),n=this._getTableDataFromTable(e),r=t.startContainer,a=r.parentNode,o="TD"===a.tagName||"TH"===a.tagName,i="TD"===r.tagName||"TH"===r.tagName,l=3===r.nodeType,u=c?"":"<br />",f=void 0,d=void 0,h=void 0,g=void 0;for(f=l&&o?a:i?r:$(r).find("th,td")[0],d=f;n.length;){for(h=n.shift();d&&h.length;)g=h.shift(),g.length?d.textContent=g:d.innerHTML=u,d=s.default.getTableCellByDirection(d,"next");d=s.default.getSiblingRowCellByDirection(f,"next",!1),f=d}}},{key:"_getTableDataFromTable",value:function(e){var t=$(e),n=[],r=t.find("tr");return r.each(function(e,t){var r=[],a=$(t).children();a.each(function(e,t){r.push(t.textContent)}),r.length&&n.push(r)}),n}},{key:"_removeTableContents",value:function(e){this.wwe.getEditor().saveUndoState(),e.each(function(e,t){var n=c?"":"<br />";$(t).html(n)})}},{key:"wrapDanglingTableCellsIntoTrIfNeed",value:function(e){var t=e.children("td,th"),n=void 0;if(t.length){var r=$("<tr></tr>");t.each(function(e,t){r.append(t)}),n=r[0]}return n}},{key:"wrapTrsIntoTbodyIfNeed",value:function(e){var t=e.children("tr"),n=t.find("th"),r=void 0;if(n.length&&n.each(function(e,t){var n=$(t),r=$("<td></td>");r.html(n.html()),r.insertBefore(t),n.detach()}),t.length){var a=$("<tbody></tbody>");t.each(function(e,t){a.append(t)}),r=a[0]}return r}},{key:"wrapTheadAndTbodyIntoTableIfNeed",value:function(e){var t=e.children("thead"),n=e.children("tbody"),r=$("<table></table>"),a=void 0;return!n.length&&t.length?(r.append(t[0]),r.append("<tbody><tr></tr></tbody>"),a=r[0]):n.length&&!t.length?(r.append("<thead><tr></tr></thead>"),r.append(n[0]),a=r[0]):n.length&&t.length&&(r.append(t[0]),r.append(n[0]),a=r[0]),a}},{key:"isTableOrSubTableElement",value:function(e){return"TABLE"===e||"TBODY"===e||"THEAD"===e||"TR"===e||"TD"===e}},{key:"_stuffTableCellsIntoIncompleteRow",value:function(e,t){e.each(function(e,n){for(var r=$(n),a=r.find("th,td"),i=s.default.getNodeName(r.parent()[0]),l="THEAD"===i?"th":"td",u=a.length;u<t;u+=1)r.append($(o(1,l))[0])})}},{key:"prepareToTableCellStuffing",value:function(e){var t=e.eq(0).find("th,td").length,n=!1;return e.each(function(e,r){var a=$(r).find("th,td").length;t!==a&&(n=!0,t<a&&(t=a))}),{maximumCellLength:t,needTableCellStuffingAid:n}}},{key:"_addTbodyOrTheadIfNeed",value:function(e){var t=!e.find("thead").length,n=!e.find("tbody").length,r=void 0;t?(r=$("<thead><tr></tr></thead>")[0],e.prepend(r)):n&&(r=$("<tbody><tr></tr></tbody>")[0],e.append(r))}},{key:"tableCellAppendAidForTableElement",value:function(e){var t=$(e);this._addTbodyOrTheadIfNeed(t),this._addTrIntoContainerIfNeed(t);var n=t.find("tr"),r=this.prepareToTableCellStuffing(n),a=r.maximumCellLength,o=r.needTableCellStuffingAid;o&&this._stuffTableCellsIntoIncompleteRow(n,a)}},{key:"_generateTheadAndTbodyFromTbody",value:function(e){var t=$("<tr></tr>"),n=$("<thead></thead>");return t.append(o($(e).find("tr").eq(0).find("td").length,"th")),n.append(t),{thead:n[0],tbody:e}}},{key:"_generateTheadAndTbodyFromThead",value:function(e){var t=$("<tr></tr>"),n=$("<tbody></tbody>");return t.append(o($(e).find("th").length,"td")),n.append(t),{thead:e,tbody:n[0]}}},{key:"_generateTheadAndTbodyFromTr",value:function(e){var t=$(e),n=$("<thead></thead>"),r=$("<tbody></tbody>"),a=void 0,i=void 0;return"TH"===t.children()[0].tagName?(a=e,i=$("<tr>"+o(t.find("th").length,"td")+"</tr>")[0]):(a=$("<tr>"+o(t.find("td").length,"th")+"</tr>")[0],i=e),n.append(a),r.append(i),{thead:n[0],tbody:r[0]}}},{key:"_completeIncompleteTable",value:function(e,t){var n=e.tagName,r=void 0,a=void 0;t=!!u.isUndefined(t)||t,"TABLE"===n?r=e:(r=$("<table></table>"),r.insertAfter(e),"TBODY"===n?a=this._generateTheadAndTbodyFromTbody(e):"THEAD"===n?a=this._generateTheadAndTbodyFromThead(e):"TR"===n&&(a=this._generateTheadAndTbodyFromTr(e)),t&&r.append(a.thead),r.append(a.tbody)),this.tableCellAppendAidForTableElement(r)}},{key:"_completeTableIfNeed",value:function(){var e=this,t=this.wwe.getEditor().get$Body();t.children().each(function(t,n){var r=$(n);e.isTableOrSubTableElement(n.nodeName)&&("TABLE"===n.nodeName&&0===r.find("thead").length&&0===r.find("tbody").length&&r.remove(),e._completeIncompleteTable(n))})}},{key:"resetLastCellNode",value:function(){this._lastCellNode=null}},{key:"setLastCellNode",value:function(e){this._lastCellNode=e}},{key:"_isSingleModifierKey",value:function(e){return"META"===e||"SHIFT"===e||"ALT"===e||"CONTROL"===e}},{key:"_isModifierKeyPushed",value:function(e){return e.metaKey||e.ctrlKey||e.altKey||e.shiftKey}},{key:"_addTrIntoContainerIfNeed",value:function(e){var t=e.children();t.each(function(e,t){var n=0===$(t).find("tr").length;n&&$(t).append($("<tr></tr>")[0])})}},{key:"_expandTableIfNeed",value:function(e){var t=this.wwe.getEditor().getSelection().cloneRange(),n=$(t.startContainer).parents("table"),r=this._getColumnAndRowDifference(e,t);r.column<0&&this._appendCellForAllRow(n,r.column),r.row<0&&this._appendRow(n,r.row)}},{key:"_getColumnAndRowDifference",value:function(e,t){var n=this._getTableDataFromTable(e),r=n.length,a=n[0].length,o=$(t.startContainer).closest("th,td"),i=o.parent(),l=s.default.getNodeOffsetOfParent(o[0]),u=s.default.getNodeOffsetOfParent(o[0].parentNode),c=i.parents("table"),f=c.find("tr").eq(0).children().length,d=c.find("tr").length,h=i.parents("tbody").length;return h&&(u+=1),{row:d-(u+r),column:f-(l+a)}}},{key:"_appendCellForAllRow",value:function(e,t){var n=c?"":"<br />";e.find("tr").each(function(e,r){for(var a=void 0,o=t;o<0;o+=1)a=0===e?"th":"td",$(r).append($("<"+a+">"+n+"</"+a+">")[0])})}},{key:"_appendRow",value:function(e,t){var n=e.find("tr").last().clone(),r=c?"":"<br />";for(n.find("td").html(r);t<0;t+=1)e.find("tbody").append(n.clone()[0])}},{key:"_getSiblingTextNodeByDirection",value:function(e,t){var n=e.previousSibling&&"BR"===e.previousSibling.nodeName&&e.previousSibling.previousSibling&&3===e.previousSibling.previousSibling.nodeType,r=e.nextSibling&&"BR"===e.nextSibling.nodeName&&e.nextSibling.nextSibling&&3===e.nextSibling.nextSibling.nodeType,a=void 0;return t&&r?a=e.nextSibling.nextSibling:!t&&n&&(a=e.previousSibling.previousSibling),a}},{key:"_changeSelectionToTargetCell",value:function(e,t,n,r){var a=t.startContainer,o="next"===n,i="row"===r,l=void 0,u=void 0;if(i){if(s.default.isTextNode(a)&&(l=this._getSiblingTextNodeByDirection(a,o)))return u=l.length<t.startOffset?l.length:t.startOffset,t.setStart(l,u),void t.collapse(!0);l=s.default.getSiblingRowCellByDirection(e,n,!1)}else l=s.default.getTableCellByDirection(e,n),l||(l=s.default.getSiblingRowCellByDirection(e,n,!0));l?(t.setStart(l,0),t.collapse(!0)):(l=$(e).parents("table")[0],o?t.setStart(l.nextElementSibling,0):l.previousElementSibling&&"TABLE"!==l.previousElementSibling.nodeName?t.setStart(l.previousElementSibling,1):t.setStartBefore(l),t.collapse(!0))}},{key:"_moveCursorTo",value:function(e,t,n){var r=this.wwe.getEditor(),a=r.getSelection().cloneRange(),o=$(a.startContainer).closest("td,th")[0],i=void 0;return a.collapsed&&this.isInTable(a)&&o&&("previous"!==e&&"row"!==t||u.isUndefined(n)||n.preventDefault(),this._changeSelectionToTargetCell(o,a,e,t),r.setSelection(a),i=!1),i}},{key:"_removeContentsAndChangeSelectionIfNeed",value:function(e,t,n){var r=t.length<=1,a="BACK_SPACE"===t||"DELETE"===t,o=this.wwe.componentManager.getManager("tableSelection").getSelectedCells(),i=o.first()[0];(r||a)&&!this._isModifierKeyPushed(n)&&o.length&&(a&&this._recordUndoStateIfNeed(e),this._removeTableContents(o),this._lastCellNode=i,e.setStart(i,0),e.collapse(!0),this.wwe.getEditor().setSelection(e))}},{key:"getTableIDClassName",value:function(){var e=f+this.tableID;return this.tableID+=1,e}},{key:"_removeBRIfNeed",value:function(e){var t=s.default.isTextNode(e.startContainer),n=t?e.startContainer.parentNode:e.startContainer,r=s.default.getNodeName(n);/td|th/i.test(r)&&e.collapsed&&1===n.textContent.length&&$(n).find("br").remove()}},{key:"_insertBRIfNeed",value:function(e){var t=s.default.isTextNode(e.startContainer),n=t?e.startContainer.parentNode:e.startContainer,r=s.default.getNodeName(n),a=$(n);!/td|th/i.test(r)||!e.collapsed||n.textContent.length||a.children().length||d||(n.normalize(),a.append("<br>"))}},{key:"destroy",value:function(){var e=this;this.eventManager.removeEventHandler("wysiwygRangeChangeAfter.table"),this.eventManager.removeEventHandler("wysiwygSetValueAfter.table"),this.eventManager.removeEventHandler("wysiwygProcessHTMLText.table"),this.eventManager.removeEventHandler("cut.table"),this.eventManager.removeEventHandler("copyBefore.table"),this.wwe.getEditor().removeEventListener("paste",this.onBindedPaste),u.forEach(this.keyEventHandlers,function(t,n){return e.wwe.removeKeyEventHandler(n,t)})}}]),e}();e.exports=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),l=r(i),s="te-cell-selected",u=function(){function e(t){a(this,e),this.wwe=t,this.eventManager=t.eventManager,this.name="tableSelection",this._init()}return o(e,[{key:"_init",value:function(){this._initEvent(),tui.util.browser.firefox&&(document.execCommand("enableObjectResizing",!1,"false"),document.execCommand("enableInlineTableEditing",!1,"false"))}},{key:"_initEvent",value:function(){var e=this,t=void 0,n=void 0,r=void 0;this._tableSelectionTimer=null,this._removeSelectionTimer=null,this._isSelectionStarted=!1;var a=function(a){n=$(a.data.target).closest("td,th")[0];var o=e.wwe.getEditor().getSelection(),i=$(n).parents("table")[0],l=t===n,u=e._isTextSelect(o,l)&&!$(t).hasClass(s);e._isSelectionStarted&&i&&!u&&(window.getSelection().removeAllRanges(),tui.util.browser.firefox&&!e._removeSelectionTimer&&(e._removeSelectionTimer=setInterval(function(){window.getSelection().removeAllRanges()},10)),e.highlightTableCellsBy(t,n),r=n)},o=function(){e._isSelectionStarted&&(e._isSelectionStarted=!1,e.eventManager.removeEventHandler("mouseover.tableSelection"),e.eventManager.removeEventHandler("mouseup.tableSelection"))},i=function(a){n=$(a.data.target).closest("td,th")[0];var i=e.wwe.getEditor().getSelection(),l=t===n,u=e._isTextSelect(i,l)&&!$(t).hasClass(s);e._clearTableSelectionTimerIfNeed(),e._isSelectionStarted&&(u?e.removeClassAttrbuteFromAllCellsIfNeed():(e.wwe.componentManager.getManager("table").resetLastCellNode(),n=n||r,i=e.wwe.getEditor().getSelection(),i.setStart(n,0),tui.util.browser.msie?i.setEnd(n,1):(i.setEnd(n,0),i.collapse(!1)),e.wwe.getEditor().setSelection(i)),e.onDragEnd&&e.onDragEnd()),o()},l=function(r){var l=2;t=$(r.data.target).closest("td,th")[0];var u=$(t).hasClass(s);n=null,!u||u&&r.data.button!==l?(e.removeClassAttrbuteFromAllCellsIfNeed(),e.setTableSelectionTimerIfNeed(t),e.eventManager.listen("mouseover.tableSelection",a),e.eventManager.listen("mouseup.tableSelection",i),e.onDragStart&&t&&e.onDragStart(t)):r.data.button===l&&o()};this.eventManager.listen("mousedown.tableSelection",l),this.eventManager.listen("copyBefore.tableSelection",o),this.eventManager.listen("pasteBefore.tableSelection",o)}},{key:"_isTextSelect",value:function(e,t){return/TD|TH|TEXT/i.test(e.commonAncestorContainer.nodeName)&&t}},{key:"setTableSelectionTimerIfNeed",value:function(e){var t=$(e).parents("table").length;t&&(this._isSelectionStarted=!0)}},{key:"_clearTableSelectionTimerIfNeed",value:function(){clearTimeout(this._tableSelectionTimer),tui.util.browser.firefox&&this._removeSelectionTimer&&(clearTimeout(this._removeSelectionTimer),this._removeSelectionTimer=null)}},{key:"_reArrangeSelectionIfneed",value:function(e,t){var n=$(e).parents("table").length,r=$(t).parents("table").length,a=r&&!n,o=!r&&n;return a?e=$(t).parents("table").find("th").first()[0]:o&&(t=$(e).parents("table").find("td").last()[0]),{startContainer:e,endContainer:t}}},{key:"_applySelectionDirection",value:function(e,t){var n=l.default.getNodeOffsetOfParent,r=e.startContainer,a=e.endContainer,o=n($(r).closest("tr")[0])-n($(a).closest("tr")[0]),i=n(r)-n(a),s=0===o,u=o<0,c=i>0;return s?c?(t.setStart(a,0),t.setEnd(r,1)):(t.setStart(r,0),t.setEnd(a,1)):u?(t.setStart(r,0),t.setEnd(a,1)):(t.setStart(a,0),t.setEnd(r,1)),t}},{key:"_getTableCell",value:function(e){return 3===e.nodeType?$(e).parent("td,th")[0]:e}},{key:"getSelectionRangeFromTable",value:function(e,t){var n=l.default.getNodeOffsetOfParent,r=n(e.parentNode),a=n(t.parentNode),o=n(e),i=n(t),s=l.default.getParentUntil(e,"TABLE"),u=l.default.getParentUntil(t,"TABLE"),c="TBODY"===l.default.getNodeName(s)&&"THEAD"===l.default.getNodeName(u),f=s!==u,d=!!$(e).parents("tbody").length&&!!$(t).parents("tbody").length,h={row:r,cell:o},g={row:a,cell:i},p=void 0,v=void 0;return c?h.row+=1:f?g.row+=1:d&&(h.row+=1,g.row+=1),r>a||r===a&&o>i?(p=g,v=h):(p=h,v=g),{from:p,to:v}}},{key:"highlightTableCellsBy",value:function(e,t){var n=$(e).parents("table").find("tr"),r=this.getSelectionRangeFromTable(e,t),a=r.from.row,o=r.from.cell,i=r.to.row,l=r.to.cell;n.each(function(e,t){$(t).find("td,th").each(function(t,n){var r=$(n),u=e===a,c=e===i;u&&t<o||c&&t>l||e<a||e>i?r.removeClass(s):r.addClass(s)})})}},{key:"removeClassAttrbuteFromAllCellsIfNeed",value:function(){this.wwe.get$Body().find("td."+s+",th."+s).each(function(e,t){var n=$(t);n.removeClass(s),n.attr("class").length||n.removeAttr("class")})}},{key:"getSelectedCells",value:function(){return this.wwe.get$Body().find("."+s)}},{key:"createRangeBySelectedCells",value:function(){var e=this.wwe.getEditor(),t=e.getSelection().cloneRange(),n=this.getSelectedCells(),r=this.wwe.componentManager.getManager("table"),a=n.first()[0],o=n.last()[0];n.length&&r.isInTable(t)&&(t.setStart(a,0),t.setEnd(o,o.childNodes.length),e.setSelection(t))}},{key:"styleToSelectedCells",value:function(e){this.createRangeBySelectedCells(),e(this.wwe.getEditor())}},{key:"destroy",value:function(){this.eventManager.removeEventHandler("mousedown.tableSelection"),this.eventManager.removeEventHandler("mouseover.tableSelection"),this.eventManager.removeEventHandler("mouseup.tableSelection"),this.eventManager.removeEventHandler("copyBefore.tableSelection"),this.eventManager.removeEventHandler("pasteBefore.tableSelection")}}]),e}();e.exports=u},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=tui.util,o=function(){function e(t,r,a){n(this,e),this.name=t,this.type=r,a&&this.setKeyMap(a)}return r(e,[{key:"getName",value:function(){return this.name}},{key:"getType",value:function(){return this.type}},{key:"isMDType",value:function(){return this.type===e.TYPE.MD}},{key:"isWWType",value:function(){return this.type===e.TYPE.WW}},{key:"isGlobalType",value:function(){return this.type===e.TYPE.GB}},{key:"setKeyMap",value:function(e,t){this.keyMap=[e,t]}}]),e}();o.factory=function(e,t){var n=void 0;"markdown"===e?n=o.TYPE.MD:"wysiwyg"===e?n=o.TYPE.WW:"global"===e&&(n=o.TYPE.GB);var r=new o(t.name,n);return a.extend(r,t),r},o.TYPE={MD:0,WW:1,GB:2},e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n="tui-color";e.eventManager.addEventType("colorButtonClicked"),e.getUI().toolbar.addButton({className:n,event:"colorButtonClicked",tooltip:d.default.get("Text color")},2);var r=e.getUI().toolbar.$el.find("button."+n),a=$("<div />"),o=$('<button type="button" class="te-apply-button">입력</button>'),i={container:a[0]};t&&(i.preset=t);var l=tui.component.colorpicker.create(i),s=l.getColor();a.append(o);var u=e.getUI().createPopup({title:!1,content:a,className:"tui-popup-color",$target:e.getUI().$el,css:{width:"auto",position:"absolute"}});e.eventManager.listen("focus",function(){u.hide()}),e.eventManager.listen("colorButtonClicked",function(){e.eventManager.emit("closeAllPopup"),u.isShow()?u.hide():(u.$el.css({top:r.position().top+r.height()+5,left:r.position().left}),u.show(),l.slider.toggle(!0))}),e.eventManager.listen("closeAllPopup",function(){u.hide()}),e.eventManager.listen("removeEditor",function(){l.off("selectColor")}),l.on("selectColor",function(t){s=t.color,"palette"===t.origin&&(e.exec("color",s),u.hide())}),u.$el.find(".te-apply-button").on("click",function(){e.exec("color",s)})}function o(e,t){return"{color:"+t+"}"+e+"{color}"}function i(e,t){return'<span style="color:'+t+'">'+e+"</span>"}function l(e){return e.replace(v,function(e,t,n,r){t=parseInt(t,10),n=parseInt(n,10),r=parseInt(r,10);var a=s(t.toString(16))+s(n.toString(16))+s(r.toString(16));return"#"+a})}function s(e){return"0"===e?"00":e}var u=n(7),c=r(u),f=n(6),d=r(f),h=/\{color:(.+?)}(.*?)\{color}/g,g=/<span (?:class="colour" )?style="color:(.+?)"(?: class="colour")?>(.*?)/g,p=/<span (?:class="colour" )?style="color:(.+?)"(?: class="colour")?>(.*?)<\/span>/g,v=/rgb\((\d+)[, ]+(\d+)[, ]+(\d+)\)/g,m="#181818";c.default.defineExtension("colorSyntax",function(e){var t=!1,n=void 0;e.options.colorSyntax&&(t=!!e.options.colorSyntax.useCustomSyntax,n=e.options.colorSyntax.preset),e.eventManager.listen("convertorAfterMarkdownToHtmlConverted",function(e){var n=void 0;return n=t?e.replace(h,function(e,t,n){return i(n,t)}):e}),e.eventManager.listen("convertorAfterHtmlToMarkdownConverted",function(e){var n=t?p:g;return e.replace(n,function(e,n,r){var a=void 0;return n.match(v)&&(n=l(n)),a=t?o(r,n):e.replace(/ ?class="colour" ?/g," ").replace(v,n)})}),e.isViewOnly()||"default"!==e.getUI().name||(e.addCommand("markdown",{name:"color",exec:function(e,n){var r=e.getEditor();n&&(t?r.replaceSelection(o(r.getSelection(),n)):r.replaceSelection(i(r.getSelection(),n)),e.focus())}}),e.addCommand("wysiwyg",{name:"color",exec:function(e,t){var n=e.getEditor();t&&(n.hasFormat("PRE")||(t===m?n.changeFormat(null,{class:"colour",tag:"span"}):n.setTextColour(t)),n.focus())}}),a(e,n))})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var a=n(7),o=r(a),i=n(21),l=r(i),s=n(22),u=r(s),c=n(24),f=r(c),d=n(23),h=r(d),g=n(20),p=r(g),v=tui.util,m=100,b=/(\n)|(\r\n)|(\r)/g;o.default.defineExtension("mark",function(e){function t(){var t=void 0;return t=e.isViewOnly()?s:e.isWysiwygMode()?o:i}function n(){var n=t();r.getAll().forEach(function(e){n.updateMarkerWithExtraInfo(e)}),e.eventManager.emit("markerUpdated",r.getAll())}var r=new l.default,a=new u.default(r),o=void 0,i=void 0,s=void 0;e.eventManager.addEventType("markerUpdated"),e.isViewOnly()?s=new h.default(e.preview):(o=new f.default(e.getSquire()),i=new p.default(e.getCodeMirror())),$(window).on("resize",n),e.on("removeEditor",function(){$(window).off("resize",n)}),e.on("setMarkdownAfter",function(){var e=t();a.resetContent(e.getTextContent())}),e.setValueWithMarkers=function(n,o){var l=void 0;return r.resetMarkers(),o.forEach(function(e){r.addMarker(e.start,e.end,e.id)}),e.setValue(n),a.resetContent(n.replace(b,"")),e.isViewOnly()||e.isWysiwygMode()?(l=t(),a.updateMarkersByContent(l.getTextContent())):l=i,r.getAll().forEach(function(e){l.updateMarkerWithExtraInfo(e)}),e.eventManager.emit("markerUpdated",r.getAll()),r.getAll()},e.getMarker=function(e){return r.getMarker(e)},e.getMarkersAll=function(){return r.getAll()},e.removeMarker=function(e){return r.removeMarker(e)},e.exportMarkers=function(){var n=void 0;return e.isMarkdownMode()?n=r.getMarkersData():(e.isViewOnly()||e.isWysiwygMode())&&(a.updateMarkersByContent(e.getValue().replace(b,"")),n=r.getMarkersData(),a.updateMarkersByContent(t().getTextContent())),n},e.selectMarker=function(n){var r=t(),a=e.getMarker(n);a&&r.selectOffsetRange(a.start,a.end)},e.addMarker=function(n,a,o){var i=void 0,l=t();return o?(i={start:n,end:a},i=l.updateMarkerWithExtraInfo(i)):(o=n,i=l.getMarkerInfoOfCurrentSelection()),i&&(i.id=o,i=r.addMarker(i),r.sortBy("end"),e.eventManager.emit("markerUpdated",[i])),i},e.clearSelect=function(){t().clearSelect()},e.isViewOnly()||(e.on("changeMode",function(){e._updateMarkers()}),e.on("change",v.debounce(function(){e._updateMarkers()},m)),e._updateMarkers=function(){var n=t();r.getAll().length&&(a.updateMarkersByContent(n.getTextContent()),r.getAll().forEach(function(e){n.updateMarkerWithExtraInfo(e)}),e.eventManager.emit("markerUpdated",r.getAll()))})})},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=tui.util,o=/(\n)|(\r\n)|(\r)/g,i=function(){function e(t){n(this,e),this.cm=t}return r(e,[{key:"getTextContent",value:function(){return this.cm.getValue().replace(o,"")}},{key:"updateMarkerWithExtraInfo",value:function(e){var t=this._findOffsetCursor([e.start,e.end]),n=t[0].line,r=t[0].ch,a=t[1].line,i=t[1].ch,l=this._getExtraInfoOfRange(n,r,a,i);return e.text=l.text.replace(o," "),e.top=l.top,e.left=l.left,e.height=l.height,e}},{key:"_getExtraInfoOfRange",value:function(e,t,n,r){var a=void 0,o=void 0,i=void 0,l=void 0,s=void 0,u=this.cm.getDoc();return u.getValue().length?(a=u.getRange({line:e,ch:t},{line:n,ch:r}),o=this.cm.charCoords({line:n,ch:r},"local"),i=o.top,l=o.left,s=o.bottom-o.top):(i=l=s=0,a=""),{text:a,top:i,left:l,height:s}}},{key:"getMarkerInfoOfCurrentSelection",value:function(){var e=this.cm.getDoc(),t=this._getSelection(),n=e.getRange({line:0,ch:0},t.anchor).replace(o,"").length,r=n+e.getSelection().replace(o,"").length,a=this._findOffsetCursor([n,r]),i=this._getExtraInfoOfRange(a[0].line,a[0].ch,a[1].line,a[1].ch);return{start:n,end:r,text:i.text.replace(o," "),top:i.top,left:i.left,height:i.height}}},{key:"_getSelection",value:function(){var e=this.cm.getDoc().listSelections()[0],t=e.anchor,n=e.head,r=t.line>n.line||t.line===n.line&&t.ch>n.ch;if(r){var a=n;n=t,t=a}return{anchor:t,head:n}}},{key:"_findOffsetCursor",value:function(e){var t=this.cm.getDoc(),n=0,r=[],o=t.lineCount(),i=0,l=0,s=void 0;for(s=0;s<o;s+=1){for(l+=t.getLine(s).length;l>=e[i];)if(r.push({line:s,ch:e[i]-n}),i+=1,a.isUndefined(e[i]))return r;n=l}for(;!a.isUndefined(e[i]);)r.push({line:s,ch:l-n}),i+=1;return r}},{key:"selectOffsetRange",value:function(e,t){var n=this._findOffsetCursor([e,t]);this.cm.setSelection({line:n[0].line,ch:n[0].ch},{line:n[1].line,ch:n[1].ch})}},{key:"clearSelect",value:function(){var e=this.cm.getDoc().listSelections()[0];e&&this.cm.setCursor(e.to())}}]),e}();e.exports=i},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=tui.util,o=function(){function e(){n(this,e),this._sortedMarkers=[],this._markersWithId={}}return r(e,[{key:"addMarker",value:function(e,t,n){var r=void 0;return r=n?{start:e,end:t,id:n}:e,this._markersWithId[r.id]||(this._sortedMarkers.push(r),this._markersWithId[r.id]=r),r}},{key:"getMarker",value:function(e){return this._markersWithId[e]}},{key:"removeMarker",value:function(e){var t=this._markersWithId[e];delete this._markersWithId[e];var n=this._sortedMarkers.indexOf(t);return this._sortedMarkers.splice(n,1),t}},{key:"updateMarker",value:function(e,t){var n=this.getMarker(e);return a.extend(n,t)}},{key:"forEachByRangeAffected",value:function(e,t,n){var r=this._getMarkersByRangeAffected(e,t);r.forEach(n)}},{key:"_getMarkersByRangeAffected",value:function(e,t){var n=this._sortedMarkers.filter(function(n){return n.end>t||n.end>e});return n}},{key:"getAll",value:function(){return this._sortedMarkers}},{key:"resetMarkers",value:function(){this._sortedMarkers=[],this._markersWithId={}}},{key:"sortBy",value:function(e){this._sortedMarkers.sort(function(t,n){return t[e]-n[e]})}},{key:"getMarkersData",value:function(){return this.getAll().map(function(e){return{start:e.start,end:e.end,id:e.id}})}}]),e}();e.exports=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(48),i=tui.util,l=0,s=1,u=-1,c=function(){function e(t){r(this,e),this._dmp=new o,this.markerList=t,this.oldTextContent=null}return a(e,[{key:"resetContent",value:function(e){this.oldTextContent=i.isString(e)?e:null}},{key:"updateMarkersByContent",value:function(e){if(i.isNull(this.oldTextContent))return this.resetContent(e),[];var t=this._makeMarkerDiffs(e);return this.oldTextContent=e,this._getUpdateMarkersWithDiffs(t)}},{key:"_makeMarkerDiffs",value:function(e){var t=this.markerList,n=this,r={};return this._forEachChanges(e,function(e,a,o){t.forEachByRangeAffected(e,a,function(t){var i=r[t.id],l=n._calculateStartDiff(e,a,o,t),s=n._calculateEndDiff(e,a,o,t);i?(i.start+=l,i.end+=s):r[t.id]={start:l,end:s}})}),r}},{key:"_forEachChanges",value:function(e,t){var n=0,r=0,a=this._dmp.diff_main(this.oldTextContent,e);a.forEach(function(e){var a=e[0],o=e[1],i=0,c=o.length;return n=r,a===l?(n+=c,void(r+=c)):(a===s?i+=c:a===u&&(i-=c,r+=c),void t(n,r,i))})}},{key:"_calculateStartDiff",value:function(e,t,n,r){var a=void 0;return a=e<=r.start&&t<=r.start?n:e<=r.start&&t>r.start?e-r.start:0}},{key:"_calculateEndDiff",value:function(e,t,n,r){var a=void 0;return a=t<=r.end?n:e<=r.end&&t>r.start?e-r.end:0}},{key:"_getUpdateMarkersWithDiffs",value:function(e){var t=[],n=this.markerList;return i.forEachOwnProperties(e,function(e,r){var a=n.getMarker(r);n.updateMarker(r,{start:a.start+=e.start,end:a.end+=e.end}),t.push(a)}),t}}]),e}();e.exports=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(){var e=window.getSelection(),t=void 0;return e&&e.rangeCount?t=e.getRangeAt(0).cloneRange():(t=document.createRange(),t.selectNodeContents(this.preview.$el[0]),t.collapse(!0)),t}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),l=/(\n)|(\r\n)|(\r)/g,s=function(){function e(t){r(this,e),this.preview=t}return o(e,[{key:"getTextContent",value:function(){return this.preview.$el[0].textContent.replace(l,"")}},{key:"updateMarkerWithExtraInfo",value:function(e){var t=this._findOffsetNode([e.start,e.end]),n=document.createRange();n.setStart(t[0].container,t[0].offsetInContainer),n.setEnd(t[1].container,t[1].offsetInContainer);var r=this._getExtraInfoOfRange(n);return e.text=r.text,e.top=r.top,e.left=r.left,e.height=r.height,e}},{key:"_getExtraInfoOfRange",value:function(e){var t=void 0,n=void 0,r=void 0,a=void 0,o=void 0,i=void 0,s=void 0,u=e.cloneContents().textContent.replace(l,"");return e.setStart(e.endContainer,e.endOffset),e.collapse(!0),r=e.getBoundingClientRect(),r&&!r.top&&(i=document.createElement("SPAN"),i.textContent="​",e.endContainer.parentNode.insertBefore(i,e.endContainer),r=i.getBoundingClientRect(),s=i.parentNode,s.removeChild(i)),r?(a=this.preview.$el.offset(),t=r.top+this.preview.$el.scrollTop()-a.top+$("body").scrollTop(),n=r.left-a.left,o=r.height):o=t=n=0,{text:u,top:t,left:n,height:o}}},{key:"getMarkerInfoOfCurrentSelection",value:function(){var e=void 0,t=void 0,n=void 0,r=void 0,o=a(),i=$.contains(this.preview.$el[0],o.commonAncestorContainer);return i&&this._extendRangeToTextNodeIfHasNone(o)?(e=o.cloneRange(),e.setStart(this.preview.$el[0],0),e.setEnd(o.startContainer,o.startOffset),r=this._getExtraInfoOfRange(o),t=e.cloneContents().textContent.length,n=t+r.text.length,{start:t,end:n,text:r.text,top:r.top,left:r.left,height:r.height}):null}},{key:"_extendRangeToTextNodeIfHasNone",value:function(e){var t=i.getChildNodeByOffset(e.endContainer,e.endOffset),n=void 0;if(!i.isTextNode(e.endContainer))if(i.isTextNode(t))e.setEnd(t,0);else{if(n=i.getPrevTextNode(t),!n)return!1;e.setEnd(n,n.length)}return!0}},{key:"_findOffsetNode",value:function(e){return i.findOffsetNode(this.preview.$el[0],e,function(e){return e.replace(l,"")})}},{key:"selectOffsetRange",value:function(e,t){var n=this._findOffsetNode([e,t]),r=document.createRange(),a=window.getSelection();r.setStart(n[0].container,n[0].offsetInContainer),
r.setEnd(n[1].container,n[1].offsetInContainer),a.removeAllRanges(),a.addRange(r)}},{key:"clearSelect",value:function(){window.getSelection().removeAllRanges()}}]),e}();e.exports=s},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),i=/\u200B/g,l=function(){function e(t){r(this,e),this.sqe=t}return a(e,[{key:"getTextContent",value:function(){return this.sqe.get$Body()[0].textContent.replace(i,"")}},{key:"updateMarkerWithExtraInfo",value:function(e){var t=this._findOffsetNode([e.start,e.end]),n=this.sqe.getSelection().cloneRange();n.setStart(t[0].container,t[0].offsetInContainer),n.setEnd(t[1].container,t[1].offsetInContainer);var r=this._getExtraInfoOfRange(n);return e.text=r.text,e.top=r.top,e.left=r.left,e.height=r.height,e}},{key:"_getExtraInfoOfRange",value:function(e){var t=void 0,n=void 0,r=void 0,a=void 0,l=void 0,s=void 0,u=void 0,c=e.endContainer,f=e.endOffset,d=e.cloneContents().textContent.replace(i,"");return o.getChildNodeByOffset(c,f)&&(e.setStart(c,f),e.collapse(!0),r=e.getBoundingClientRect()),r&&!r.top&&this.sqe.modifyDocument(function(){l=document.createElement("SPAN"),l.textContent="​",e.endContainer.parentNode.insertBefore(l,e.endContainer),r=l.getBoundingClientRect(),s=l.parentNode,s.removeChild(l)}),r?(u=this.sqe.get$Body().parent().offset(),t=this.sqe.scrollTop()+r.top-u.top+$("body").scrollTop(),n=r.left-u.left,a=r.height):a=t=n=0,{text:d,top:t,left:n,height:a}}},{key:"getMarkerInfoOfCurrentSelection",value:function(){var e=void 0,t=void 0,n=void 0,r=void 0,a=this.sqe.getSelection().cloneRange();return this._extendRangeToTextNodeIfHasNone(a)?(e=a.cloneRange(),e.setStart(this.sqe.get$Body()[0],0),e.setEnd(a.startContainer,a.startOffset),r=this._getExtraInfoOfRange(a),t=e.cloneContents().textContent.length,n=t+r.text.length,{start:t,end:n,text:r.text,top:r.top,left:r.left,height:r.height}):null}},{key:"_extendRangeToTextNodeIfHasNone",value:function(e){var t=o.getChildNodeByOffset(e.endContainer,e.endOffset),n=void 0;if(!o.isTextNode(e.endContainer)||!t.nodeValue.replace(i,"").length)if(o.isTextNode(t))e.setEnd(t,0);else{if(n=o.getPrevTextNode(t),!n)return!1;e.setEnd(n,n.length)}return!0}},{key:"_findOffsetNode",value:function(e){return o.findOffsetNode(this.sqe.get$Body()[0],e,function(e){return e.replace(i,"")})}},{key:"selectOffsetRange",value:function(e,t){var n=this._findOffsetNode([e,t]),r=this.sqe.getSelection().cloneRange();r.setStart(n[0].container,n[0].offsetInContainer),r.setEnd(n[1].container,n[1].offsetInContainer),this.sqe.setSelection(r)}},{key:"clearSelect",value:function(){var e=this.sqe.getSelection().cloneRange();e.collapse(!0),this.sqe.setSelection(e)}}]),e}();e.exports=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var a=n(6),o=r(a);o.default.setLang(["ko","ko_KR"],{"Merge cells":"셀 병합","Unmerge cells":"셀 병합해제","Cannot change part of merged cell":"병합 된 셀의 일부를 변경할 수 없습니다.","Cannot paste row merged cells into the table header":"테이블 헤더에는 행 병합된 셀을 붙여넣을 수 없습니다."}),o.default.setLang(["en","en_US"],{"Merge cells":"Merge cells","Unmerge cells":"Unmerge cells","Cannot change part of merged cell":"Cannot change part of merged cell.","Cannot paste row merged cells into the table header":"Cannot paste row merged cells into the table header."}),o.default.setLang(["ja","ja_JP"],{"Merge cells":"セルの結合","Unmerge cells":"セルの結合を解除","Cannot change part of merged cell":"結合されたセルの一部を変更することはできません。","Cannot paste row merged cells into the table header":"行にマージされたセルをヘッダーに貼り付けることはできません。"}),o.default.setLang(["nl","nl_NL"],{"Merge cells":"cellen samenvoegen","Unmerge cells":"Samenvoegen cellen ongedaan maken","Cannot change part of merged cell":"Kan geen deel uit van samengevoegde cel te veranderen.","Cannot paste row merged cells into the table header":"Kan niet plakken rij samengevoegde cellen in de koptekst. "}),o.default.setLang(["zh","zh_CN"],{"Merge cells":"合并单元格","Unmerge cells":"取消合并单元格","Cannot change part of merged cell":"无法更改合并单元格的一部分。","Cannot paste row merged cells into the table header":"无法将行合并单元格粘贴到标题中。"})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t,n){var r,o=n+1,i=(r=[]).concat.apply(r,a(e.map(function(e){return e.slice(t,o)}))),l=i.filter(function(e){var t=e.content;return t&&t!==w});return l.length?l[0].content:w}function i(e,t,n){var r,o=n+1,i=e.map(function(e){return e.slice(t,o)});(r=[]).concat.apply(r,a(i)).slice(1).forEach(function(e){var t=e.nodeName;y.forEach(e,function(t,n){return delete e[n]}),e.nodeName=t})}function l(e,t,n,r){var a=n+1;e.forEach(function(e){e.slice(t,a).forEach(function(e){e.rowMergeWith=r})})}function s(e,t,n,r){var a=n+1;e.forEach(function(e){e.slice(t,a).forEach(function(e){e.colMergeWith=r})})}function u(e,t){var n=t.start,r=t.end,a=n.rowIndex,u=n.colIndex,c=r.rowIndex,f=r.colIndex,d=e[a][u],h=e.slice(a,c+1),g=c-a+1,p=f-u+1;d.rowspan=g,d.colspan=p,d.content=o(h,u,f),i(h,u,f),g>1&&l(h.slice(1),u,f,a),p>1&&s(h,u+1,f,u)}function c(e,t,n){var r=g.default.createTableData(e),a=g.default.findElementIndex(r,t,n);return e.find("tr").eq(a.rowIndex).find("td, th")[a.colIndex]}Object.defineProperty(t,"__esModule",{value:!0}),t._mergeCells=u;var f=n(1),d=r(f),h=n(3),g=r(h),p=n(4),v=r(p),m=n(5),b=r(m),y=tui.util,w=y.browser.msie?"":"<br>",_=d.default.command("wysiwyg",{name:"MergeCells",exec:function(e){var t=e.getEditor();if(t.focus(),t.hasFormat("TABLE")){var n=e.componentManager.getManager("tableSelection"),r=n.getSelectedCells();if(!(r.length<2||n.hasSelectedBothThAndTd(r))){var a=t.getSelection().cloneRange(),o=$(a.startContainer),i=o.closest("table"),l=g.default.createTableData(i),s=v.default.getTableSelectionRange(l,r,o);u(l,s);var f=b.default.replaceTable(i,l),d=c(f,s.start.rowIndex,s.start.colIndex);b.default.focusToCell(t,a,d)}}}});t.default=_},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){return{nodeName:t,colMergeWith:e}}function i(e,t,n,r){var a=e[n],i=void 0;if(b.isExisty(a.colMergeWith)){var l=a.colMergeWith,s=e[l],u=l+s.colspan-1;b.isExisty(s.rowMergeWith)&&r?i=b.extend({},r):u>n&&(s.colspan+=1,i=b.extend({},a))}else a.colspan>1&&(a.colspan+=1,i=o(n,a.nodeName));return i||(i=h.default.createBasicCell(t,n+1,a.nodeName)),i}function l(e,t,n){var r=b.range(t,n+1),a=[],o=null;return e.forEach(function(e,t){var l=r.map(function(r,a){var l=o?o[a-1]:null;return i(e,t,n,l)});o=l,a.push(l)}),a}function s(e,t){var n=t.end,r=h.default.findColMergedLastIndex(e,n.rowIndex,n.colIndex),o=l(e,t.start.colIndex,r),i=r+1;e.forEach(function(e,t){e.splice.apply(e,a([i,0].concat(o[t])))})}function u(e,t,n){var r=h.default.createTableData(e),a=h.default.findColMergedLastIndex(r,t,n)+1,o=h.default.findElementIndex(r,t,a);return e.find("tr").eq(o.rowIndex).find("td, th")[o.colIndex]}Object.defineProperty(t,"__esModule",{value:!0}),t._createNewColumns=l,t._addColumns=s;var c=n(1),f=r(c),d=n(3),h=r(d),g=n(4),p=r(g),v=n(5),m=r(v),b=tui.util,y=f.default.command("wysiwyg",{name:"AddCol",exec:function(e){var t=e.getEditor(),n=t.getSelection().cloneRange();if(t.focus(),t.hasFormat("TABLE")){var r=$(n.startContainer),a=r.closest("table"),o=h.default.createTableData(a),i=e.componentManager.getManager("tableSelection").getSelectedCells(),l=p.default.getTableSelectionRange(o,i,r);s(o,l);var c=m.default.replaceTable(a,o),f=u(c,l.start.rowIndex,l.end.colIndex);m.default.focusToCell(t,n,f)}}});t.default=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e){return{nodeName:"TD",rowMergeWith:e}}function i(e,t){var n=null;return e[t].map(function(r,a){var i=void 0;if(m.isExisty(r.rowMergeWith)){var l=r.rowMergeWith,s=e[l][a],u=l+s.rowspan-1;m.isExisty(s.colMergeWith)&&n?i=m.extend({},n):u>t&&(s.rowspan+=1,i=m.extend({},r))}else r.rowspan>1&&(r.rowspan+=1,i=o(t));return i||(i=d.default.createBasicCell(t+1,a)),n=i,i})}function l(e,t){var n=t.start.rowIndex,r=t.end,o=d.default.findRowMergedLastIndex(e,r.rowIndex,r.colIndex),l=m.range(n,o+1).map(function(){return i(e,o)});e.splice.apply(e,a([o+1,0].concat(l)))}function s(e,t,n){var r=d.default.createTableData(e),a=d.default.findRowMergedLastIndex(r,t,n)+1,o=d.default.findElementIndex(r,a,n);return e.find("tr").eq(o.rowIndex).find("td")[o.colIndex]}Object.defineProperty(t,"__esModule",{value:!0}),t._createNewRow=i,t._addRow=l;var u=n(1),c=r(u),f=n(3),d=r(f),h=n(4),g=r(h),p=n(5),v=r(p),m=tui.util,b=c.default.command("wysiwyg",{name:"AddRow",exec:function(e){var t=e.getEditor(),n=t.getSelection().cloneRange();if(t.focus(),t.hasFormat("TABLE")){var r=$(n.startContainer),a=r.closest("table"),o=d.default.createTableData(a),i=e.componentManager.getManager("tableSelection").getSelectedCells(),u=g.default.getTableSelectionRange(o,i,r);l(o,u);var c=v.default.replaceTable(a,o),f=s(c,u.end.rowIndex,u.start.colIndex);v.default.focusToCell(t,n,f)}}});t.default=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r){g.range(t,n+1).forEach(function(t){var n=e[t];g.isExisty(n.colMergeWith)?e[n.colMergeWith].align=r:n.align=r})}function o(e,t){var n=u.default.findElementRowIndex(t),r=u.default.findElementColIndex(t);return e.find("tr").eq(n).find("td, th")[r]}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),l=r(i),s=n(3),u=r(s),c=n(4),f=r(c),d=n(5),h=r(d),g=tui.util,p=l.default.command("wysiwyg",{name:"AlignCol",exec:function(e,t){var n=e.getEditor(),r=n.getSelection().cloneRange();if(n.focus(),n.hasFormat("TABLE")){var i=$(r.startContainer),l=i.closest("table"),s=u.default.createTableData(l),c=e.componentManager.getManager("tableSelection").getSelectedCells(),d=f.default.getTableSelectionRange(s,c,i);a(s[0],d.start.colIndex,d.end.colIndex,t);var g=h.default.replaceTable(l,s),p=o(g,i);h.default.focusToCell(n,r,p)}}});t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){var r=new RegExp("^((?:"+n+"=[0-9]+:)?)"+t+"=([0-9]+):(.*)"),a=r.exec(e),o=1;return a&&(o=parseInt(a[2],10),e=a[1]+a[3]),[o,e]}function o(e){var t=e.nodeName,n=e.align||"",r=e.innerHTML.trim(),o=null,i=null,l=a(r,"@cols","@rows"),s=h(l,2);o=s[0],r=s[1];var u=a(r,"@rows","@cols"),c=h(u,2);return i=c[0],r=c[1],{nodeName:t,colspan:o,rowspan:i,content:r,align:n}}function i(e){return e.find("tr").get().map(function(e){return $(e).find("td, th").get().map(o)})}function l(e,t){var n=-1;return tui.util.forEach(e,function(e,r){var a=!0;return t(e,r)&&(n=r,a=!1),a}),n}function s(e){var t=l(e,function(e){return"TD"===e[0].nodeName});return[e.slice(0,t),e.slice(t)]}function u(e){e.forEach(function(e){var t=e.length,n=0;e.forEach(function(e){n+=e.colspan-1}),e.splice(t-n)})}function c(e){var t=e.map(function(e,t){return t}),n=t.map(function(){return 0});return e.forEach(function(e,r){var a=e.filter(function(e){return e.rowspan>1}),o=r+1;a.forEach(function(e){var r=e.colspan,a=o+(e.rowspan-1);t.slice(o,a).forEach(function(e){n[e]+=r})})}),n}function f(e){var t=c(e);e.forEach(function(e,n){e.splice(e.length-t[n])})}function d(e){var t=i($(e)),n=s(t),r=h(n,2),a=r[0],o=r[1];return u(a),u(o),f(o),$(p.default.createTableHtml(t))[0]}Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function e(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&l.return&&l.return()}finally{if(a)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t._extractPropertiesForMerge=a,t._parseTableCell=o,t._createTableObjectFrom$Table=i,t._divideTrs=s,t._mergeByColspan=u,t._getRemovalTdCountsByRowspan=c,t._mergeByRowspan=f,t.default=d;var g=n(5),p=r(g)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){e.forEach(function(e){v.range(t,n+1).forEach(function(t){var r=e[t];if(v.isExisty(r.colMergeWith)){var a=e[r.colMergeWith];a.colspan&&(a.colspan-=1)}else if(r.colspan>1){var o=t+r.colspan-1;r.colspan-=n-t+1,o>n&&(e[n+1]=v.extend({},r))}})})}function o(e,t,n){e.forEach(function(e){e.slice(n+1).forEach(function(e){v.isExisty(e.colMergeWith)&&e.colMergeWith>=t&&(e.colMergeWith=n+1)})})}function i(e,t){var n=t.start.colIndex,r=t.end,i=f.default.findColMergedLastIndex(e,r.rowIndex,r.colIndex),l=i-n+1;l!==e[0].length&&(a(e,n,i),o(e,n,i),e.forEach(function(e){e.splice(n,l)}))}function l(e,t,n){var r=f.default.createTableData(e);r[0].length-1<n&&(n-=1);var a=f.default.findElementIndex(r,t,n);return e.find("tr").eq(a.rowIndex).find("td, th")[a.colIndex]}Object.defineProperty(t,"__esModule",{value:!0}),t._removeColumns=i;var s=n(1),u=r(s),c=n(3),f=r(c),d=n(4),h=r(d),g=n(5),p=r(g),v=tui.util,m=u.default.command("wysiwyg",{name:"RemoveCol",exec:function(e){var t=e.getEditor(),n=t.getSelection().cloneRange();if(t.focus(),t.hasFormat("TABLE")){var r=$(n.startContainer),a=r.closest("table"),o=f.default.createTableData(a),s=e.componentManager.getManager("tableSelection").getSelectedCells(),u=h.default.getTableSelectionRange(o,s,r),c=o[0].length;if(i(o,u),c!==o[0].length){var d=p.default.replaceTable(a,o),g=l(d,u.start.rowIndex,u.end.colIndex);p.default.focusToCell(t,n,g)}}}});t.default=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){v.range(t,n+1).forEach(function(t){e[t].forEach(function(r,a){if(v.isExisty(r.rowMergeWith)){var o=e[r.rowMergeWith][a];o.rowspan&&(o.rowspan-=1)}else if(r.rowspan>1){var i=t+r.rowspan-1;r.rowspan-=n-t+1,i>n&&(e[n+1][a]=v.extend({},r))}})})}function o(e,t,n){e.slice(n+1).forEach(function(e){e.forEach(function(e){v.isExisty(e.rowMergeWith)&&e.rowMergeWith>=t&&(e.rowMergeWith=n+1)})})}function i(e,t){var n=t.start.rowIndex,r=t.end,i=f.default.findRowMergedLastIndex(e,r.rowIndex,r.colIndex),l=i-n+1;l!==e.length-1&&(a(e,n,i),o(e,n,i),e.splice(n,l))}function l(e,t,n){var r=f.default.createTableData(e);r.length-1<t&&(t-=1);var a=f.default.findElementIndex(r,t,n);return e.find("tr").eq(a.rowIndex).find("td")[a.colIndex]}Object.defineProperty(t,"__esModule",{value:!0}),t._removeRow=i;var s=n(1),u=r(s),c=n(3),f=r(c),d=n(4),h=r(d),g=n(5),p=r(g),v=tui.util,m=u.default.command("wysiwyg",{name:"RemoveRow",exec:function(e){var t=e.getEditor(),n=t.getSelection().cloneRange();if(t.focus(),t.hasFormat("TABLE")){var r=$(n.startContainer),a=r.closest("table"),o=f.default.createTableData(a),s=o.length,u=e.componentManager.getManager("tableSelection").getSelectedCells(),c=h.default.getTableSelectionRange(o,u,r);if(i(o,c),s!==o.length){var d=p.default.replaceTable(a,o),g=l(d,c.end.rowIndex,c.start.colIndex);p.default.focusToCell(t,n,g)}}}});t.default=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=['<button type="button" class="te-table-add-row">'+s.default.get("Add row")+"</button>",'<button type="button" class="te-table-add-col">'+s.default.get("Add col")+"</button>",'<button type="button" class="te-table-remove-row">'+s.default.get("Remove row")+"</button>",'<button type="button" class="te-table-remove-col">'+s.default.get("Remove col")+"</button>",'<button type="button" class="te-table-merge">'+s.default.get("Merge cells")+"</button>",'<button type="button" class="te-table-unmerge">'+s.default.get("Unmerge cells")+"</button>",'<button type="button" class="te-table-col-align-left">'+s.default.get("Align left")+"</button>",'<button type="button" class="te-table-col-align-center">'+s.default.get("Align center")+"</button>",'<button type="button" class="te-table-col-align-right">'+s.default.get("Align right")+"</button>",'<button type="button" class="te-table-remove">'+s.default.get("Remove table")+"</button>"].join(""),n=$(t);e.$content=n,e.setContent(n)}function o(e,t,n){var r=e.$content,a=$(r[4]),o=$(r[5]);e.on("click .te-table-merge",function(){t.emit("command","MergeCells")}),e.on("click .te-table-unmerge",function(){t.emit("command","UnmergeCells")}),t.listen("openPopupTableUtils",function(){var e=n.getSelectedCells(),t=e.length;t?(t<2||n.hasSelectedBothThAndTd(e)?a.hide():a.show(),e.is("[rowspan], [colspan]")?o.show():o.hide()):(a.hide(),o.hide())})}function i(e,t,n){a(e),o(e,t,n)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(6),s=r(l);t.default={updateContextMenu:i}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){e.addCommand(O.default),e.addCommand(D.default)}function o(e){e.removeManager("table"),e.removeManager("tableSelection"),e.addManager(b.default),e.addManager(w.default)}function i(e,t){var n=$("<div>"+e+"</div>"),r=n.find("table");return r.length&&(r.get().forEach(function(e){var n=t(e);$(e).replaceWith(n)}),e=n.html()),e}function l(e){var t=e.command;if(t.isWWType())switch(t.getName()){case"AddRow":e.command=k.default;break;case"AddCol":e.command=C.default;break;case"RemoveRow":e.command=M.default;break;case"RemoveCol":e.command=I.default;break;case"AlignCol":e.command=N.default}}function s(e){e.listen("convertorAfterMarkdownToHtmlConverted",function(e){return i(e,d.default)}),e.listen("convertorBeforeHtmlToMarkdownConverted",function(e){return i(e,g.default)}),e.listen("addCommandBefore",l)}var u=n(7),c=r(u),f=n(30),d=r(f),h=n(35),g=r(h),p=n(36),v=r(p),m=n(38),b=r(m),y=n(39),w=r(y),_=n(28),k=r(_),x=n(27),C=r(x),T=n(32),M=r(T),E=n(31),I=r(E),S=n(29),N=r(S),A=n(26),O=r(A),R=n(37),D=r(R),B=n(33),P=r(B);n(25),c.default.defineExtension("tableExtension",function(e){var t=e.eventManager;if(e.toMarkOptions=e.toMarkOptions||{},e.toMarkOptions.renderer=v.default,s(t),!e.isViewOnly()){var n=e.wwEditor.componentManager,r=e._ui.popupTableUtils;a(e),o(n),e._ui.popupTableUtils&&P.default.updateContextMenu(r,t,n.getManager("tableSelection"))}})},function(e,t){"use strict";function n(e){var t=$(e),n=t.attr("colspan")||"",r=t.attr("rowspan")||"",a=t.html();n&&(a="@cols="+n+":"+a),r&&(a="@rows="+r+":"+a),a&&t.html(a)}function r(e){return $(e).find("td, th").get().forEach(n),e}Object.defineProperty(t,"__esModule",{value:!0}),t._prependMergeSyntaxToContent=n,t.default=r},function(e,t){"use strict";function n(e,t){return tui.util.range(0,t).map(function(){return e}).join("")}function r(e){var t=e.align,r=(e.textContent||e.innerText).replace(l,""),a=r.length,o="",i="";return t&&("left"===t?(o=":",a-=1):"right"===t?(i=":",a-=1):"center"===t&&(i=":",o=":",a-=2)),a=Math.max(a,3),o+n("-",a)+i}function a(e){var t=0;return e.filter(function(e){return $(e).attr("colspan")}).forEach(function(e){t+=parseInt($(e).attr("colspan"),10)-1}),t}function o(e,t){var o=$(e).find("th").get(),i=o.map(function(e){return" "+r(e)+" |"}).join("");return i+=n(" --- |",a(o)),t?t+"|"+i+"\n":""}Object.defineProperty(t,"__esModule",{value:!0}),t._getAdditionalThCount=a,t._createTheadMarkdown=o;var i=window.toMark,l=/@cols=[0-9]+:/g;t.default=i.Renderer.factory(i.gfmRenderer,{THEAD:o})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){var n,r=t.start,o=t.end,i=r.colIndex,l=o.colIndex+1,s=e.slice(r.rowIndex,o.rowIndex+1),u=s.map(function(e){return e.slice(i,l)});return!!(n=[]).concat.apply(n,a(u)).filter(function(e){return e.colspan>1||e.rowspan>1}).length}function i(e,t,n,r,a){var o=t+r,i=n+a,l=m.range(n,i);m.range(t,o).forEach(function(n){var r=e[n],a=n===t?1:0;l.slice(a).forEach(function(e){r[e]=d.default.createBasicCell(n,e,r[e].nodeName)})})}function l(e,t){var n=t.start,r=t.end,a=m.range(n.colIndex,r.colIndex+1);m.range(n.rowIndex,r.rowIndex+1).forEach(function(t){a.forEach(function(n){var r=e[t][n],a=r.colspan,o=r.rowspan;(a>1||o>1)&&(r.colspan=1,r.rowspan=1,i(e,t,n,o,a))})})}function s(e,t,n){var r=d.default.createTableData(e),a=d.default.findElementIndex(r,t,n);return e.find("tr").eq(a.rowIndex).find("td, th")[a.colIndex]}Object.defineProperty(t,"__esModule",{value:!0}),t._hasMergedCell=o,t._unmergeCells=l;var u=n(1),c=r(u),f=n(3),d=r(f),h=n(4),g=r(h),p=n(5),v=r(p),m=tui.util,b=c.default.command("wysiwyg",{name:"UnmergeCells",exec:function(e){var t=e.getEditor(),n=t.getSelection().cloneRange();if(t.focus(),t.hasFormat("TABLE")){var r=$(n.startContainer),a=r.closest("table"),i=d.default.createTableData(a),u=e.componentManager.getManager("tableSelection").getSelectedCells(),c=g.default.getTableSelectionRange(i,u,r);if(o(i,c)){l(i,c);var f=v.default.replaceTable(a,i),h=s(f,c.start.rowIndex,c.start.colIndex);v.default.focusToCell(t,n,h)}}}});t.default=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){var n=!1;return w.forEach(e,function(e){return n=t(e),!n}),n}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(15),f=r(c),d=n(3),h=r(d),g=n(5),p=r(g),v=n(4),m=r(v),b=n(6),y=r(b),w=tui.util,_="tui-paste-table-bookmark",k="tui-paste-table-cell-bookmark",x=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),u(t,[{key:"_updateCopyDataMergeWith",value:function(e,t){e.forEach(function(e){e.forEach(function(e){w.isExisty(e.rowMergeWith)&&(e.rowMergeWith-=t.rowIndex),w.isExisty(e.colMergeWith)&&(e.colMergeWith-=t.colIndex)})})}},{key:"_createCopyTableData",value:function(e,t,n){var r=e.slice(t.rowIndex,n.rowIndex+1);return r=r.map(function(e){return e.slice(t.colIndex,n.colIndex+1)}),this._updateCopyDataMergeWith(r,t),r}},{key:"updateTableHtmlOfClipboardIfNeed",value:function(e){var t=this.wwe.componentManager.getManager("tableSelection").getSelectedCells();if(t.length){var n=h.default.createTableData($(t[0]).closest("TABLE")),r=m.default.getTableSelectionRange(n,t),a=r.start,o=r.end,i=this._createCopyTableData(n,a,o),l=h.default.createCellIndexData(i),s=h.default.createRenderData(i,l);e.html(p.default.createTableHtml(s))}}},{key:"prepareToTableCellStuffing",value:function(e){var t=e[0].length,n=!1;return e.slice(1).forEach(function(e){var r=e.length;t!==r&&(n=!0,t<r&&(t=r))}),{maximumCellLength:t,needTableCellStuffingAid:n}}},{key:"tableCellAppendAidForTableElement",value:function(e){var t=$(e),n=h.default.createTableData(t),r=h.default.addTbodyOrTheadIfNeed(n),a=this.prepareToTableCellStuffing(n),o=a.needTableCellStuffingAid;o&&h.default.stuffCellsIntoIncompleteRow(n,a.maximumCellLength),(r||o)&&p.default.replaceTable(t,n)}},{key:"_findStartCell",value:function(e){var t=void 0;return t=1===e.length?e[0]:this.wwe.getEditor().getSelection().startContainer}},{key:"_findStartCellIndex",value:function(e,t){var n=h.default.createCellIndexData(e);return h.default.findCellIndex(n,t)}},{key:"_hasRowMergedHeader",value:function(e,t,n){var r="TH"===t[n.rowIndex][n.colIndex].nodeName,a=s(e[0],function(e){return e.rowspan&&e.rowspan>1});return r&&a}},{key:"_isExactlyFit",value:function(e,t,n){return t%e.length===0&&n%e[0].length===0}},{key:"_updateClipboardTableData",value:function(e,t,n){var r=e.length,o=e[0].length,i=parseInt(t/r,10),l=parseInt(n/o,10);if(i>1){var s=JSON.parse(JSON.stringify(e));w.range(0,i-1).forEach(function(){var t=JSON.parse(JSON.stringify(s));e.push.apply(e,a(t))})}if(l>1){var u=JSON.parse(JSON.stringify(e));w.range(0,l-1).forEach(function(){var t=JSON.parse(JSON.stringify(u));e.forEach(function(e,n){e.push.apply(e,a(t[n]))})})}}},{key:"_updateTableDataByClipboardData",value:function(e,t,n){var r=n.rowIndex,a=n.colIndex;e.forEach(function(e,n){var o=r+n;e.forEach(function(e,n){var r=a+n,i=t[o][r];e.nodeName=i.nodeName,t[o][r]=e})})}},{key:"_isPossibleToPaste",value:function(e,t,n){var r=t.rowIndex,a=t.colIndex,o=n.rowIndex,i=n.colIndex,l=e.slice(r,o+1),u=l[0].slice(a,i+1),c=!s(u,function(e){return w.isExisty(e.rowMergeWith)});if(c){var f=w.pluck(l,a);c=!s(f,function(e){return w.isExisty(e.colMergeWith)})}if(c&&e.length>o+1){var d=e[o+1].slice(a,i+1);c=!s(d,function(e){return w.isExisty(e.rowMergeWith)})}if(c&&e[0].length>i+1){var h=w.pluck(l,i+1);c=!s(h,function(e){return w.isExisty(e.colMergeWith)})}return c}},{key:"_spliceClipboardData",value:function(e,t,n){e.splice(t),e.forEach(function(e){e.splice(n)})}},{key:"_bookmarkLastTd",value:function(e){var t=e.rowIndex,n=e.colIndex,r=this.wwe.getEditor(),a=r.get$Body().find("."+_),o=h.default.createTableData(a),i=o[t][n];t=w.isExisty(i.rowMergeWith)?i.rowMergeWith:t,n=w.isExisty(i.colMergeWith)?i.colMergeWith:n;var l=o[t][n].elementIndex,s=a.find("tr").eq(l.rowIndex).children()[l.colIndex];a.removeClass(_),$(s).addClass(k)}},{key:"_updateClipboardDataForPasteToSamllerSelectedArea",value:function(e,t,n,r,a){var o=!0,i={rowIndex:0,colIndex:0},l={rowIndex:n-1,colIndex:r-1};return this._isPossibleToPaste(e,i,l)?(this._spliceClipboardData(e,n,r),this._updateTableDataByClipboardData(e,t,a)):o=!1,o}},{key:"_pasteToSelectedArea",value:function(e,t,n,r){var a=m.default.getTableSelectionRange(n,r),o=a.start,i=a.end,l=i.rowIndex-o.rowIndex+1,s=i.colIndex-o.colIndex+1,u=t.length,c=t[0].length,f=l>=u&&s>=c,d=y.default.get("Cannot change part of merged cell"),h=!0,g=void 0;this._hasRowMergedHeader(t,n,o)?(d=y.default.get("Cannot paste row merged cells into the table header"),h=!1):this._isExactlyFit(t,l,s)?(g=i,this._updateClipboardTableData(t,l,s),this._updateTableDataByClipboardData(t,n,o)):f?(g={rowIndex:o.rowIndex+u-1,colIndex:o.colIndex+c-1},this._isPossibleToPaste(n,o,g)?this._updateTableDataByClipboardData(t,n,o):h=!1):(g={rowIndex:o.rowIndex+l-1,colIndex:o.colIndex+s-1},h=this._updateClipboardDataForPasteToSamllerSelectedArea(t,n,l,s,o)),h?(n.className+=" "+_,p.default.replaceTable(e,n),this._bookmarkLastTd(g)):(alert(d),this.wwe.getEditor().focus())}},{key:"_findEndCellIndex",value:function(e,t){var n=t.rowIndex,r=t.colIndex;return{rowIndex:n+e.length-1,colIndex:r+e[0].length-1}}},{key:"_expandRow",value:function(e,t){var n=e.length,r=e[0].length,o=w.range(n,n+t).map(function(e){return w.range(0,r).map(function(t){return h.default.createBasicCell(e,t)})});e.push.apply(e,a(o))}},{key:"_expandCoumn",value:function(e,t){var n=e[0].length,r=w.range(n,n+t);e.forEach(function(e,t){var n=e[0].nodeName,o=r.map(function(e){return h.default.createBasicCell(t,e,n)});e.push.apply(e,a(o))})}},{key:"_expandTableDataIfNeed",value:function(e,t,n){var r=n.rowIndex-e.length+1,a=n.colIndex-e[0].length+1;r>0&&this._expandRow(e,r),a>0&&this._expandCoumn(e,a)}},{key:"_pasteAllClipboardTableData",value:function(e,t,n,r){var a=this._findEndCellIndex(t,r);return this._hasRowMergedHeader(t,n,r)?(alert(y.default.get("Cannot paste row merged cells into the table header")),void this.wwe.getEditor().focus()):(this._expandTableDataIfNeed(n,r,a),void(this._isPossibleToPaste(n,r,a)?(this._updateTableDataByClipboardData(t,n,r),n.className+=" "+_,p.default.replaceTable(e,n),this._bookmarkLastTd(a)):(alert(y.default.get("Cannot change part of merged cell")),this.wwe.getEditor().focus())))}},{key:"pasteClipboardData",value:function(e){var t=h.default.createTableData(e),n=this.wwe.componentManager.getManager("tableSelection"),r=n.getSelectedCells(),a=$(this._findStartCell(r)),o=a.closest("table"),i=h.default.createTableData(o),l=this._findStartCellIndex(i,a);r.length>1?this._pasteToSelectedArea(o,t,i,r):this._pasteAllClipboardTableData(o,t,i,l)}}]),t}(f.default);e.exports=x},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(16),u=r(s),c=n(3),f=r(c),d=n(4),h=r(d),g="te-cell-selected",p=tui.util,v=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._tableData=null,n.mergedTableSelectionManager=!0,n}return i(t,e),l(t,[{key:"_addClassToSelectedCells",value:function(e,t,n){var r=n.start,a=n.end,o=p.range(r.colIndex,a.colIndex+1),i=e.find("tr");p.range(r.rowIndex,a.rowIndex+1).forEach(function(e){var n=t[e],r=i.eq(e).find("td, th");return o.forEach(function(e){var t=n[e];t.elementIndex&&r.eq(n[e].elementIndex.colIndex).addClass(g)})})}},{key:"onDragStart",value:function(e){var t=$(e).closest("table");this._tableData=f.default.createTableData(t)}},{key:"onDragEnd",value:function(){this._tableData=null}},{key:"highlightTableCellsBy",value:function(e,t){var n=$(e),r=$(t),a=n.closest("table"),o=h.default.findSelectionRange(this._tableData,n,r);this.removeClassAttrbuteFromAllCellsIfNeed(),this._addClassToSelectedCells(a,this._tableData,o)}},{key:"styleToSelectedCells",value:function(e){var t=this.wwe.getEditor(),n=t.getSelection().cloneRange(),r=$(n.startContainer).closest("table");r.find("tr").get().forEach(function(r){var a=$(r).find("."+g),o=a.first()[0],i=a.last()[0];a.length&&(n.setStart(o,0),n.setEnd(i,i.childNodes.length),t.setSelection(n),e(t))})}},{key:"hasSelectedBothThAndTd",value:function(e){return e=e||this.getSelectedCells(),e.first()[0].nodeName!==e.last()[0].nodeName}}]),t}(u.default);t.default=v},function(e,t,n){"use strict";var r=n(7),a=/^\s*\* \[[xX ]\] [^\n]*/gm,o=/^\s*\* \[[xX]\] [^\n]*/gm;r.defineExtension("taskCounter",function(e){e.getTaskCount=function(){var t=void 0,n=void 0;return e.isViewOnly()?n=e.preview.$el.find(".task-list-item").length:e.isMarkdownMode()?(t=e.mdEditor.getValue().match(a),n=t?t.length:0):n=e.wwEditor.get$Body().find(".task-list-item").length,n},e.getCheckedTaskCount=function(){var t=void 0,n=void 0;return e.isViewOnly()?n=e.preview.$el.find(".task-list-item.checked").length:e.isMarkdownMode()?(t=e.mdEditor.getValue().match(o),n=t?t.length:0):n=e.wwEditor.get$Body().find(".task-list-item.checked").length,n}})},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");
}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=tui.util,o=function(){function e(){n(this,e),this.globalTOID=null,this.lazyRunFunctions={}}return r(e,[{key:"run",value:function(e,t,n,r){var o=void 0;return a.isString(e)?o=this._runRegisteredRun(e,t,n,r):(o=this._runSingleRun(e,t,n,r,this.globalTOID),this.globalTOID=o),o}},{key:"registerLazyRunFunction",value:function(e,t,n,r){r=r||this,this.lazyRunFunctions[e]={fn:t,delay:n,context:r,TOID:null}}},{key:"_runSingleRun",value:function(e,t,n,r,a){return this._clearTOIDIfNeed(a),a=setTimeout(function(){e.call(n,t)},r)}},{key:"_runRegisteredRun",value:function(e,t,n,r){var a=this.lazyRunFunctions[e].fn,o=this.lazyRunFunctions[e].TOID;return r=r||this.lazyRunFunctions[e].delay,n=n||this.lazyRunFunctions[e].context,o=this._runSingleRun(a,t,n,r,o),this.lazyRunFunctions[e].TOID=o,o}},{key:"_clearTOIDIfNeed",value:function(e){e&&clearTimeout(e)}}]),e}();e.exports=o},function(e,t){"use strict";function n(e){switch(e){case 9:case 32:return!0}return!1}e.exports=function(e,t,r,a){var o,i,l,s,u,c,f,d,h,g,p,v,m,b,y,w,_=/(?:-|\*|\d+\.) {1,4}(?:> {0,3})[^>]*$/,k=e.src.split("\n"),x=k[t],C=e.bMarks[t]+e.tShift[t],T=e.eMarks[t];if(x.match(_)||62!==e.src.charCodeAt(C++))return!1;if(a)return!0;for(32===e.src.charCodeAt(C)&&C++,c=e.blkIndent,e.blkIndent=0,h=g=e.sCount[t]+C-(e.bMarks[t]+e.tShift[t]),u=[e.bMarks[t]],e.bMarks[t]=C;C<T&&(p=e.src.charCodeAt(C),n(p));)9===p?g+=4-g%4:g++,C++;for(i=C>=T,s=[e.sCount[t]],e.sCount[t]=g-h,l=[e.tShift[t]],e.tShift[t]=C-e.bMarks[t],v=e.md.block.ruler.getRules("blockquote"),o=t+1;o<r&&!(e.sCount[o]<c)&&(C=e.bMarks[o]+e.tShift[o],T=e.eMarks[o],!(C>=T));o++)if(62!==e.src.charCodeAt(C++)){if(i)break;for(w=!1,b=0,y=v.length;b<y;b++)if(v[b](e,o,r,!0)){w=!0;break}if(w)break;u.push(e.bMarks[o]),l.push(e.tShift[o]),s.push(e.sCount[o]),e.sCount[o]=-1}else{for(32===e.src.charCodeAt(C)&&C++,h=g=e.sCount[o]+C-(e.bMarks[o]+e.tShift[o]),u.push(e.bMarks[o]),e.bMarks[o]=C;C<T&&(p=e.src.charCodeAt(C),n(p));)9===p?g+=4-g%4:g++,C++;i=C>=T,s.push(e.sCount[o]),e.sCount[o]=g-h,l.push(e.tShift[o]),e.tShift[o]=C-e.bMarks[o]}for(f=e.parentType,e.parentType="blockquote",m=e.push("blockquote_open","blockquote",1),m.markup=">",m.map=d=[t,0],e.md.block.tokenize(e,t,o),m=e.push("blockquote_close","blockquote",-1),m.markup=">",e.parentType=f,d[1]=e.line,b=0;b<l.length;b++)e.bMarks[b+t]=u[b],e.tShift[b+t]=l[b],e.sCount[b+t]=s[b];return e.blkIndent=c,!0}},function(e,t){"use strict";function n(e,t,n){var r=e.attrIndex(t),a=[t,n];r<0?e.attrPush(a):e.attrs[r]=a}function r(e){return e.block===!0&&"code"===e.tag&&"fence"===e.type}function a(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var o=function(e){e.core.ruler.after("block","tui-code-block",function(e){var t,o,i=e.tokens;for(o=0;o<i.length;o+=1)t=i[o],r(t)&&t.info&&n(t,"data-language",a(t.info.replace(" ",""),!0))})};e.exports=o},function(e,t){"use strict";e.exports=function(e,t,n){var r,a,o,i=/ {0,3}(?:-|\*|\d\.) /,l=e.src.split("\n"),s=l[t],u=0;if(s.match(i)||e.sCount[t]-e.blkIndent<4)return!1;for(a=r=t+1;r<n;)if(e.isEmpty(r)){if(u++,u>=2&&"list"===e.parentType)break;r++}else{if(u=0,!(e.sCount[r]-e.blkIndent>=4))break;r++,a=r}return e.line=a,o=e.push("code_block","code",0),o.content=e.getLines(t,a,4+e.blkIndent,!0),o.map=[t,e.line],!0}},function(e,t){"use strict";var n=["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],r=[[/^<(script|pre|style)(?=(\s|>|$))/i,/<\/(script|pre|style)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^<("+n.join("|")+")","i"),/^\/?>$/,!0],[new RegExp("^</?(address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|pre|section|source|title|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?=(\\s|/?>|$))","i"),/^$/,!0],[/^(?:<[A-Za-z][A-Za-z0-9\-]*(?:\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\s*=\s*(?:[^"'=<>`\x00-\x20]+|'[^']*'|"[^"]*"))?)*\s*\/?>|<\/[A-Za-z][A-Za-z0-9\-]*\s*>)\s*$/,/^$/,!1]];e.exports=function(e,t,n,a){var o,i,l,s,u=e.bMarks[t]+e.tShift[t],c=e.eMarks[t];if(!e.md.options.html)return!1;if(60!==e.src.charCodeAt(u))return!1;for(s=e.src.slice(u,c),o=0;o<r.length;o++)if(r[o][0].test(s)){if(5===o)return!1;break}if(o===r.length)return!1;if(a)return r[o][2];if(i=t+1,!r[o][1].test(s))for(;i<n&&!(e.sCount[i]<e.blkIndent);i++)if(u=e.bMarks[i]+e.tShift[i],c=e.eMarks[i],s=e.src.slice(u,c),r[o][1].test(s)){0!==s.length&&i++;break}return e.line=i,l=e.push("html_block","",0),l.map=[t,i],l.content=e.getLines(t,i,e.blkIndent,!0),!0}},function(e,t){"use strict";function n(e,t){var n=e.bMarks[t]+e.blkIndent,r=e.eMarks[t];return e.src.substr(n,r-n)}function r(e){var t,n=[],r=0,a=e.length,o=0,i=0,l=!1,s=0;for(t=e.charCodeAt(r);r<a;)96===t&&o%2===0?(l=!l,s=r):124!==t||o%2!==0||l?92===t?o+=1:o=0:(n.push(e.substring(i,r)),i=r+1),r+=1,r===a&&l&&(l=!1,r=s+1),t=e.charCodeAt(r);return n.push(e.substring(i)),n}e.exports=function(e,t,a,o){var i,l,s,u,c,f,d,h,g,p,v,m,b;if(t+2>a)return!1;if(c=t+1,e.sCount[c]<e.blkIndent)return!1;if(s=e.bMarks[c]+e.tShift[c],s>=e.eMarks[c])return!1;if(i=e.src.charCodeAt(s),124!==i&&45!==i&&58!==i)return!1;if(l=n(e,t+1),!/^[-:| ]+$/.test(l))return!1;for(f=l.split("|"),g=[],u=0;u<f.length;u+=1){if(v=f[u].trim(),!v){if(0===u||u===f.length-1)continue;return!1}if(!/^:?-+:?$/.test(v))return!1;58===v.charCodeAt(v.length-1)?g.push(58===v.charCodeAt(0)?"center":"right"):58===v.charCodeAt(0)?g.push("left"):g.push("")}if(p=g.length,l=n(e,t).trim(),l.indexOf("|")===-1)return!1;if(f=r(l.replace(/^\||\|$/g,"")),d=f.length,d>p)return!1;if(d<p){for(u=0;u<p-d;u+=1)f.push("");d=f.length}if(o)return!0;for(h=e.push("table_open","table",1),h.map=m=[t,0],h=e.push("thead_open","thead",1),h.map=[t,t+1],h=e.push("tr_open","tr",1),h.map=[t,t+1],u=0;u<d;u+=1)h=e.push("th_open","th",1),h.map=[t,t+1],g[u]&&(h.attrs=[["align",g[u]]]),h=e.push("inline","",0),h.content=f[u].trim(),h.map=[t,t+1],h.children=[],h=e.push("th_close","th",-1);for(h=e.push("tr_close","tr",-1),h=e.push("thead_close","thead",-1),h=e.push("tbody_open","tbody",1),h.map=b=[t+2,0],c=t+2;c<a&&!(e.sCount[c]<e.blkIndent)&&(l=n(e,c),l.indexOf("|")!==-1);c+=1){for(f=r(l.replace(/^\||\|\s*$/g,"")),h=e.push("tr_open","tr",1),u=0;u<d;u+=1)h=e.push("td_open","td",1),g[u]&&(h.attrs=[["align",g[u]]]),h=e.push("inline","",0),h.content=f[u]?f[u].trim():"",h.children=[],h=e.push("td_close","td",-1);h=e.push("tr_close","tr",-1)}return h=e.push("tbody_close","tbody",-1),h=e.push("table_close","table",-1),m[1]=b[1]=c,e.line=c,!0}},function(e,t){"use strict";function n(e){e.content=e.content.slice(4),e.children[0].content=e.children[0].content.slice(4)}function r(e){var t=!1;return 0!==e.content.indexOf("[x]")&&0!==e.content.indexOf("[X]")||(t=!0),t}function a(e,t,n){var r=e.attrIndex(t),a=[t,n];r<0?e.attrPush(a):e.attrs[r]=a}function o(e,t){return"inline"===e[t].type&&"paragraph_open"===e[t-1].type&&"list_item_open"===e[t-2].type&&(0===e[t].content.indexOf("[ ]")||0===e[t].content.indexOf("[x]")||0===e[t].content.indexOf("[X]"))}var i=function(e){e.core.ruler.after("inline","tui-task-list",function(e){var t,i,l="task-list-item",s="checked",u=e.tokens;for(i=2;i<u.length;i+=1)o(u,i)&&(t=r(u[i])?l+" "+s:l,n(u[i]),a(u[i-2],"class",t),a(u[i-2],"data-te-task",""))})};e.exports=i},function(e,t){"use strict";function n(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=-1,o=1,i=0;n.Diff,n.prototype.diff_main=function(e,t,n,r){"undefined"==typeof r&&(r=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var a=r;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[[i,e]]:[];"undefined"==typeof n&&(n=!0);var o=n,l=this.diff_commonPrefix(e,t),s=e.substring(0,l);e=e.substring(l),t=t.substring(l),l=this.diff_commonSuffix(e,t);var u=e.substring(e.length-l);e=e.substring(0,e.length-l),t=t.substring(0,t.length-l);var c=this.diff_compute_(e,t,o,a);return s&&c.unshift([i,s]),u&&c.push([i,u]),this.diff_cleanupMerge(c),c},n.prototype.diff_compute_=function(e,t,n,r){var l;if(!e)return[[o,t]];if(!t)return[[a,e]];var s=e.length>t.length?e:t,u=e.length>t.length?t:e,c=s.indexOf(u);if(c!=-1)return l=[[o,s.substring(0,c)],[i,u],[o,s.substring(c+u.length)]],e.length>t.length&&(l[0][0]=l[2][0]=a),l;if(1==u.length)return[[a,e],[o,t]];var f=this.diff_halfMatch_(e,t);if(f){var d=f[0],h=f[1],g=f[2],p=f[3],v=f[4],m=this.diff_main(d,g,n,r),b=this.diff_main(h,p,n,r);return m.concat([[i,v]],b)}return n&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,r):this.diff_bisect_(e,t,r)},n.prototype.diff_lineMode_=function(e,t,n){var r=this.diff_linesToChars_(e,t);e=r.chars1,t=r.chars2;var l=r.lineArray,s=this.diff_main(e,t,!1,n);this.diff_charsToLines_(s,l),this.diff_cleanupSemantic(s),s.push([i,""]);for(var u=0,c=0,f=0,d="",h="";u<s.length;){switch(s[u][0]){case o:f++,h+=s[u][1];break;case a:c++,d+=s[u][1];break;case i:if(c>=1&&f>=1){s.splice(u-c-f,c+f),u=u-c-f;for(var r=this.diff_main(d,h,!1,n),g=r.length-1;g>=0;g--)s.splice(u,0,r[g]);u+=r.length}f=0,c=0,d="",h=""}u++}return s.pop(),s},n.prototype.diff_bisect_=function(e,t,n){for(var r=e.length,i=t.length,l=Math.ceil((r+i)/2),s=l,u=2*l,c=new Array(u),f=new Array(u),d=0;d<u;d++)c[d]=-1,f[d]=-1;c[s+1]=0,f[s+1]=0;for(var h=r-i,g=h%2!=0,p=0,v=0,m=0,b=0,y=0;y<l&&!((new Date).getTime()>n);y++){for(var w=-y+p;w<=y-v;w+=2){var _,k=s+w;_=w==-y||w!=y&&c[k-1]<c[k+1]?c[k+1]:c[k-1]+1;for(var x=_-w;_<r&&x<i&&e.charAt(_)==t.charAt(x);)_++,x++;if(c[k]=_,_>r)v+=2;else if(x>i)p+=2;else if(g){var C=s+h-w;if(C>=0&&C<u&&f[C]!=-1){var T=r-f[C];if(_>=T)return this.diff_bisectSplit_(e,t,_,x,n)}}}for(var M=-y+m;M<=y-b;M+=2){var T,C=s+M;T=M==-y||M!=y&&f[C-1]<f[C+1]?f[C+1]:f[C-1]+1;for(var E=T-M;T<r&&E<i&&e.charAt(r-T-1)==t.charAt(i-E-1);)T++,E++;if(f[C]=T,T>r)b+=2;else if(E>i)m+=2;else if(!g){var k=s+h-M;if(k>=0&&k<u&&c[k]!=-1){var _=c[k],x=s+_-k;if(T=r-T,_>=T)return this.diff_bisectSplit_(e,t,_,x,n)}}}}return[[a,e],[o,t]]},n.prototype.diff_bisectSplit_=function(e,t,n,r,a){var o=e.substring(0,n),i=t.substring(0,r),l=e.substring(n),s=t.substring(r),u=this.diff_main(o,i,!1,a),c=this.diff_main(l,s,!1,a);return u.concat(c)},n.prototype.diff_linesToChars_=function(e,t){function n(e){for(var t="",n=0,o=-1,i=r.length;o<e.length-1;){o=e.indexOf("\n",n),o==-1&&(o=e.length-1);var l=e.substring(n,o+1);n=o+1,(a.hasOwnProperty?a.hasOwnProperty(l):void 0!==a[l])?t+=String.fromCharCode(a[l]):(t+=String.fromCharCode(i),a[l]=i,r[i++]=l)}return t}var r=[],a={};r[0]="";var o=n(e),i=n(t);return{chars1:o,chars2:i,lineArray:r}},n.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var r=e[n][1],a=[],o=0;o<r.length;o++)a[o]=t[r.charCodeAt(o)];e[n][1]=a.join("")}},n.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),a=r,o=0;n<a;)e.substring(o,a)==t.substring(o,a)?(n=a,o=n):r=a,a=Math.floor((r-n)/2+n);return a},n.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),a=r,o=0;n<a;)e.substring(e.length-a,e.length-o)==t.substring(t.length-a,t.length-o)?(n=a,o=n):r=a,a=Math.floor((r-n)/2+n);return a},n.prototype.diff_commonOverlap_=function(e,t){var n=e.length,r=t.length;if(0==n||0==r)return 0;n>r?e=e.substring(n-r):n<r&&(t=t.substring(0,n));var a=Math.min(n,r);if(e==t)return a;for(var o=0,i=1;;){var l=e.substring(a-i),s=t.indexOf(l);if(s==-1)return o;i+=s,0!=s&&e.substring(a-i)!=t.substring(0,i)||(o=i,i++)}},n.prototype.diff_halfMatch_=function(e,t){function n(e,t,n){for(var r,a,o,l,s=e.substring(n,n+Math.floor(e.length/4)),u=-1,c="";(u=t.indexOf(s,u+1))!=-1;){var f=i.diff_commonPrefix(e.substring(n),t.substring(u)),d=i.diff_commonSuffix(e.substring(0,n),t.substring(0,u));c.length<d+f&&(c=t.substring(u-d,u)+t.substring(u,u+f),r=e.substring(0,n-d),a=e.substring(n+f),o=t.substring(0,u-d),l=t.substring(u+f))}return 2*c.length>=e.length?[r,a,o,l,c]:null}if(this.Diff_Timeout<=0)return null;var r=e.length>t.length?e:t,a=e.length>t.length?t:e;if(r.length<4||2*a.length<r.length)return null;var o,i=this,l=n(r,a,Math.ceil(r.length/4)),s=n(r,a,Math.ceil(r.length/2));if(!l&&!s)return null;o=s?l&&l[4].length>s[4].length?l:s:l;var u,c,f,d;e.length>t.length?(u=o[0],c=o[1],f=o[2],d=o[3]):(f=o[0],d=o[1],u=o[2],c=o[3]);var h=o[4];return[u,c,f,d,h]},n.prototype.diff_cleanupSemantic=function(e){for(var t=!1,n=[],r=0,l=null,s=0,u=0,c=0,f=0,d=0;s<e.length;)e[s][0]==i?(n[r++]=s,u=f,c=d,f=0,d=0,l=e[s][1]):(e[s][0]==o?f+=e[s][1].length:d+=e[s][1].length,l&&l.length<=Math.max(u,c)&&l.length<=Math.max(f,d)&&(e.splice(n[r-1],0,[a,l]),e[n[r-1]+1][0]=o,r--,r--,s=r>0?n[r-1]:-1,u=0,c=0,f=0,d=0,l=null,t=!0)),s++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),s=1;s<e.length;){if(e[s-1][0]==a&&e[s][0]==o){var h=e[s-1][1],g=e[s][1],p=this.diff_commonOverlap_(h,g),v=this.diff_commonOverlap_(g,h);p>=v?(p>=h.length/2||p>=g.length/2)&&(e.splice(s,0,[i,g.substring(0,p)]),e[s-1][1]=h.substring(0,h.length-p),e[s+1][1]=g.substring(p),s++):(v>=h.length/2||v>=g.length/2)&&(e.splice(s,0,[i,h.substring(0,v)]),e[s-1][0]=o,e[s-1][1]=g.substring(0,g.length-v),e[s+1][0]=a,e[s+1][1]=h.substring(v),s++),s++}s++}},n.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var r=e.charAt(e.length-1),a=t.charAt(0),o=r.match(n.nonAlphaNumericRegex_),i=a.match(n.nonAlphaNumericRegex_),l=o&&r.match(n.whitespaceRegex_),s=i&&a.match(n.whitespaceRegex_),u=l&&r.match(n.linebreakRegex_),c=s&&a.match(n.linebreakRegex_),f=u&&e.match(n.blanklineEndRegex_),d=c&&t.match(n.blanklineStartRegex_);return f||d?5:u||c?4:o&&!l&&s?3:l||s?2:o||i?1:0}for(var r=1;r<e.length-1;){if(e[r-1][0]==i&&e[r+1][0]==i){var a=e[r-1][1],o=e[r][1],l=e[r+1][1],s=this.diff_commonSuffix(a,o);if(s){var u=o.substring(o.length-s);a=a.substring(0,a.length-s),o=u+o.substring(0,o.length-s),l=u+l}for(var c=a,f=o,d=l,h=t(a,o)+t(o,l);o.charAt(0)===l.charAt(0);){a+=o.charAt(0),o=o.substring(1)+l.charAt(0),l=l.substring(1);var g=t(a,o)+t(o,l);g>=h&&(h=g,c=a,f=o,d=l)}e[r-1][1]!=c&&(c?e[r-1][1]=c:(e.splice(r-1,1),r--),e[r][1]=f,d?e[r+1][1]=d:(e.splice(r+1,1),r--))}r++}},n.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,n.whitespaceRegex_=/\s/,n.linebreakRegex_=/[\r\n]/,n.blanklineEndRegex_=/\n\r?\n$/,n.blanklineStartRegex_=/^\r?\n\r?\n/,n.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,n=[],r=0,l=null,s=0,u=!1,c=!1,f=!1,d=!1;s<e.length;)e[s][0]==i?(e[s][1].length<this.Diff_EditCost&&(f||d)?(n[r++]=s,u=f,c=d,l=e[s][1]):(r=0,l=null),f=d=!1):(e[s][0]==a?d=!0:f=!0,l&&(u&&c&&f&&d||l.length<this.Diff_EditCost/2&&u+c+f+d==3)&&(e.splice(n[r-1],0,[a,l]),e[n[r-1]+1][0]=o,r--,l=null,u&&c?(f=d=!0,r=0):(r--,s=r>0?n[r-1]:-1,f=d=!1),t=!0)),s++;t&&this.diff_cleanupMerge(e)},n.prototype.diff_cleanupMerge=function(e){e.push([i,""]);for(var t,n=0,r=0,l=0,s="",u="";n<e.length;)switch(e[n][0]){case o:l++,u+=e[n][1],n++;break;case a:r++,s+=e[n][1],n++;break;case i:r+l>1?(0!==r&&0!==l&&(t=this.diff_commonPrefix(u,s),0!==t&&(n-r-l>0&&e[n-r-l-1][0]==i?e[n-r-l-1][1]+=u.substring(0,t):(e.splice(0,0,[i,u.substring(0,t)]),n++),u=u.substring(t),s=s.substring(t)),t=this.diff_commonSuffix(u,s),0!==t&&(e[n][1]=u.substring(u.length-t)+e[n][1],u=u.substring(0,u.length-t),s=s.substring(0,s.length-t))),0===r?e.splice(n-l,r+l,[o,u]):0===l?e.splice(n-r,r+l,[a,s]):e.splice(n-r-l,r+l,[a,s],[o,u]),n=n-r-l+(r?1:0)+(l?1:0)+1):0!==n&&e[n-1][0]==i?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,l=0,r=0,s="",u=""}""===e[e.length-1][1]&&e.pop();var c=!1;for(n=1;n<e.length-1;)e[n-1][0]==i&&e[n+1][0]==i&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),c=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),c=!0)),n++;c&&this.diff_cleanupMerge(e)},n.prototype.diff_xIndex=function(e,t){var n,r=0,i=0,l=0,s=0;for(n=0;n<e.length&&(e[n][0]!==o&&(r+=e[n][1].length),e[n][0]!==a&&(i+=e[n][1].length),!(r>t));n++)l=r,s=i;return e.length!=n&&e[n][0]===a?s:s+(t-l)},n.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,r=/</g,l=/>/g,s=/\n/g,u=0;u<e.length;u++){var c=e[u][0],f=e[u][1],d=f.replace(n,"&amp;").replace(r,"&lt;").replace(l,"&gt;").replace(s,"&para;<br>");switch(c){case o:t[u]='<ins style="background:#e6ffe6;">'+d+"</ins>";break;case a:t[u]='<del style="background:#ffe6e6;">'+d+"</del>";break;case i:t[u]="<span>"+d+"</span>"}}return t.join("")},n.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==o&&(t[n]=e[n][1]);return t.join("")},n.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==a&&(t[n]=e[n][1]);return t.join("")},n.prototype.diff_levenshtein=function(e){for(var t=0,n=0,r=0,l=0;l<e.length;l++){var s=e[l][0],u=e[l][1];switch(s){case o:n+=u.length;break;case a:r+=u.length;break;case i:t+=Math.max(n,r),n=0,r=0}}return t+=Math.max(n,r)},n.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case o:t[n]="+"+encodeURI(e[n][1]);break;case a:t[n]="-"+e[n][1].length;break;case i:t[n]="="+e[n][1].length}return t.join("\t").replace(/%20/g," ")},n.prototype.diff_fromDelta=function(e,t){for(var n=[],r=0,l=0,s=t.split(/\t/g),u=0;u<s.length;u++){var c=s[u].substring(1);switch(s[u].charAt(0)){case"+":try{n[r++]=[o,decodeURI(c)]}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+c)}break;case"-":case"=":var f=parseInt(c,10);if(isNaN(f)||f<0)throw new Error("Invalid number in diff_fromDelta: "+c);var d=e.substring(l,l+=f);"="==s[u].charAt(0)?n[r++]=[i,d]:n[r++]=[a,d];break;default:if(s[u])throw new Error("Invalid diff operation in diff_fromDelta: "+s[u])}}if(l!=e.length)throw new Error("Delta length ("+l+") does not equal source text length ("+e.length+").");return n},n.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},n.prototype.match_bitap_=function(e,t,n){function r(e,r){var a=e/t.length,i=Math.abs(n-r);return o.Match_Distance?a+i/o.Match_Distance:i?1:a}if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var a=this.match_alphabet_(t),o=this,i=this.Match_Threshold,l=e.indexOf(t,n);l!=-1&&(i=Math.min(r(0,l),i),l=e.lastIndexOf(t,n+t.length),l!=-1&&(i=Math.min(r(0,l),i)));var s=1<<t.length-1;l=-1;for(var u,c,f,d=t.length+e.length,h=0;h<t.length;h++){for(u=0,c=d;u<c;)r(h,n+c)<=i?u=c:d=c,c=Math.floor((d-u)/2+u);d=c;var g=Math.max(1,n-c+1),p=Math.min(n+c,e.length)+t.length,v=Array(p+2);v[p+1]=(1<<h)-1;for(var m=p;m>=g;m--){var b=a[e.charAt(m-1)];if(0===h?v[m]=(v[m+1]<<1|1)&b:v[m]=(v[m+1]<<1|1)&b|((f[m+1]|f[m])<<1|1)|f[m+1],v[m]&s){var y=r(h,m-1);if(y<=i){if(i=y,l=m-1,!(l>n))break;g=Math.max(1,2*n-l)}}}if(r(h+1,n)>i)break;f=v}return l},n.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(var n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},n.prototype.patch_addContext_=function(e,t){if(0!=t.length){for(var n=t.substring(e.start2,e.start2+e.length1),r=0;t.indexOf(n)!=t.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,n=t.substring(e.start2-r,e.start2+e.length1+r);r+=this.Patch_Margin;var a=t.substring(e.start2-r,e.start2);a&&e.diffs.unshift([i,a]);var o=t.substring(e.start2+e.length1,e.start2+e.length1+r);o&&e.diffs.push([i,o]),e.start1-=a.length,e.start2-=a.length,e.length1+=a.length+o.length,e.length2+=a.length+o.length}},n.prototype.patch_make=function(e,t,l){var s,u;if("string"==typeof e&&"string"==typeof t&&"undefined"==typeof l)s=e,u=this.diff_main(s,t,!0),u.length>2&&(this.diff_cleanupSemantic(u),this.diff_cleanupEfficiency(u));else if(e&&"object"==("undefined"==typeof e?"undefined":r(e))&&"undefined"==typeof t&&"undefined"==typeof l)u=e,s=this.diff_text1(u);else if("string"==typeof e&&t&&"object"==("undefined"==typeof t?"undefined":r(t))&&"undefined"==typeof l)s=e,u=t;else{if("string"!=typeof e||"string"!=typeof t||!l||"object"!=("undefined"==typeof l?"undefined":r(l)))throw new Error("Unknown call format to patch_make.");s=e,u=l}if(0===u.length)return[];for(var c=[],f=new n.patch_obj,d=0,h=0,g=0,p=s,v=s,m=0;m<u.length;m++){var b=u[m][0],y=u[m][1];switch(d||b===i||(f.start1=h,f.start2=g),b){case o:f.diffs[d++]=u[m],f.length2+=y.length,v=v.substring(0,g)+y+v.substring(g);break;case a:f.length1+=y.length,f.diffs[d++]=u[m],v=v.substring(0,g)+v.substring(g+y.length);break;case i:y.length<=2*this.Patch_Margin&&d&&u.length!=m+1?(f.diffs[d++]=u[m],f.length1+=y.length,f.length2+=y.length):y.length>=2*this.Patch_Margin&&d&&(this.patch_addContext_(f,p),c.push(f),f=new n.patch_obj,d=0,p=v,h=g)}b!==o&&(h+=y.length),b!==a&&(g+=y.length)}return d&&(this.patch_addContext_(f,p),c.push(f)),c},n.prototype.patch_deepCopy=function(e){for(var t=[],r=0;r<e.length;r++){var a=e[r],o=new n.patch_obj;o.diffs=[];for(var i=0;i<a.diffs.length;i++)o.diffs[i]=a.diffs[i].slice();o.start1=a.start1,o.start2=a.start2,o.length1=a.length1,o.length2=a.length2,t[r]=o}return t},n.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var r=0,l=[],s=0;s<e.length;s++){var u,c=e[s].start2+r,f=this.diff_text1(e[s].diffs),d=-1;if(f.length>this.Match_MaxBits?(u=this.match_main(t,f.substring(0,this.Match_MaxBits),c),u!=-1&&(d=this.match_main(t,f.substring(f.length-this.Match_MaxBits),c+f.length-this.Match_MaxBits),(d==-1||u>=d)&&(u=-1))):u=this.match_main(t,f,c),u==-1)l[s]=!1,r-=e[s].length2-e[s].length1;else{l[s]=!0,r=u-c;var h;if(h=d==-1?t.substring(u,u+f.length):t.substring(u,d+this.Match_MaxBits),f==h)t=t.substring(0,u)+this.diff_text2(e[s].diffs)+t.substring(u+f.length);else{var g=this.diff_main(f,h,!1);if(f.length>this.Match_MaxBits&&this.diff_levenshtein(g)/f.length>this.Patch_DeleteThreshold)l[s]=!1;else{this.diff_cleanupSemanticLossless(g);for(var p,v=0,m=0;m<e[s].diffs.length;m++){var b=e[s].diffs[m];b[0]!==i&&(p=this.diff_xIndex(g,v)),b[0]===o?t=t.substring(0,u+p)+b[1]+t.substring(u+p):b[0]===a&&(t=t.substring(0,u+p)+t.substring(u+this.diff_xIndex(g,v+b[1].length))),b[0]!==a&&(v+=b[1].length)}}}}}return t=t.substring(n.length,t.length-n.length),[t,l]},n.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,n="",r=1;r<=t;r++)n+=String.fromCharCode(r);for(var r=0;r<e.length;r++)e[r].start1+=t,e[r].start2+=t;var a=e[0],o=a.diffs;if(0==o.length||o[0][0]!=i)o.unshift([i,n]),a.start1-=t,a.start2-=t,a.length1+=t,a.length2+=t;else if(t>o[0][1].length){var l=t-o[0][1].length;o[0][1]=n.substring(o[0][1].length)+o[0][1],a.start1-=l,a.start2-=l,a.length1+=l,a.length2+=l}if(a=e[e.length-1],o=a.diffs,0==o.length||o[o.length-1][0]!=i)o.push([i,n]),a.length1+=t,a.length2+=t;else if(t>o[o.length-1][1].length){var l=t-o[o.length-1][1].length;o[o.length-1][1]+=n.substring(0,l),a.length1+=l,a.length2+=l}return n},n.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,r=0;r<e.length;r++)if(!(e[r].length1<=t)){var l=e[r];e.splice(r--,1);for(var s=l.start1,u=l.start2,c="";0!==l.diffs.length;){var f=new n.patch_obj,d=!0;for(f.start1=s-c.length,f.start2=u-c.length,""!==c&&(f.length1=f.length2=c.length,f.diffs.push([i,c]));0!==l.diffs.length&&f.length1<t-this.Patch_Margin;){var h=l.diffs[0][0],g=l.diffs[0][1];h===o?(f.length2+=g.length,u+=g.length,f.diffs.push(l.diffs.shift()),d=!1):h===a&&1==f.diffs.length&&f.diffs[0][0]==i&&g.length>2*t?(f.length1+=g.length,s+=g.length,d=!1,f.diffs.push([h,g]),l.diffs.shift()):(g=g.substring(0,t-f.length1-this.Patch_Margin),f.length1+=g.length,s+=g.length,h===i?(f.length2+=g.length,u+=g.length):d=!1,f.diffs.push([h,g]),g==l.diffs[0][1]?l.diffs.shift():l.diffs[0][1]=l.diffs[0][1].substring(g.length))}c=this.diff_text2(f.diffs),c=c.substring(c.length-this.Patch_Margin);var p=this.diff_text1(l.diffs).substring(0,this.Patch_Margin);""!==p&&(f.length1+=p.length,f.length2+=p.length,0!==f.diffs.length&&f.diffs[f.diffs.length-1][0]===i?f.diffs[f.diffs.length-1][1]+=p:f.diffs.push([i,p])),d||e.splice(++r,0,f)}}},n.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},n.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var r=e.split("\n"),l=0,s=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;l<r.length;){var u=r[l].match(s);if(!u)throw new Error("Invalid patch string: "+r[l]);var c=new n.patch_obj;for(t.push(c),c.start1=parseInt(u[1],10),""===u[2]?(c.start1--,c.length1=1):"0"==u[2]?c.length1=0:(c.start1--,c.length1=parseInt(u[2],10)),c.start2=parseInt(u[3],10),""===u[4]?(c.start2--,c.length2=1):"0"==u[4]?c.length2=0:(c.start2--,c.length2=parseInt(u[4],10)),l++;l<r.length;){var f=r[l].charAt(0);try{var d=decodeURI(r[l].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+d)}if("-"==f)c.diffs.push([a,d]);else if("+"==f)c.diffs.push([o,d]);else if(" "==f)c.diffs.push([i,d]);else{if("@"==f)break;if(""!==f)throw new Error('Invalid patch mode "'+f+'" in: '+d)}l++}}return t},n.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},n.patch_obj.prototype.toString=function(){var e,t;e=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1,t=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2;for(var n,r=["@@ -"+e+" +"+t+" @@\n"],l=0;l<this.diffs.length;l++){switch(this.diffs[l][0]){case o:n="+";break;case a:n="-";break;case i:n=" "}r[l+1]=n+encodeURI(this.diffs[l][1])+"\n"}return r.join("").replace(/%20/g," ")},e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(14),l=r(i),s=n(12),u=r(s),c=n(1),f=r(c),d=n(7),h=r(d),g=n(11),p=r(g),v=n(8),m=r(v),b=tui.util,y="data-te-task",w="checked",_=function(){function e(t){var n=this;a(this,e),this.options=t,this.eventManager=new u.default,this.commandManager=new f.default(this),this.convertor=new p.default(this.eventManager),this.codeBlockManager=m.default,this.toMarkOptions=null,this.options.hooks&&b.forEach(this.options.hooks,function(e,t){n.addHook(t,e)}),this.options.events&&b.forEach(this.options.events,function(e,t){n.on(t,e)}),this.preview=new l.default($(this.options.el),this.eventManager,this.convertor,!0),this.preview.$el.on("mousedown",$.proxy(this._toggleTask,this)),h.default.applyExtension(this,this.options.exts),this.setValue(this.options.initialValue),this.eventManager.emit("load",this)}return o(e,[{key:"_toggleTask",value:function(e){var t=e.offsetX<18&&e.offsetY>18;e.target.hasAttribute(y)&&!t&&($(e.target).toggleClass(w),this.eventManager.emit("change",{source:"viewOnly",data:e}))}},{key:"setMarkdown",value:function(e){this.markdownValue=e=e||"",this.preview.refresh(this.markdownValue),this.eventManager.emit("setMarkdownAfter",this.markdownValue)}},{key:"setValue",value:function(e){this.setMarkdown(e)}},{key:"on",value:function(e,t){this.eventManager.listen(e,t)}},{key:"off",value:function(e){this.eventManager.removeEventHandler(e)}},{key:"remove",value:function(){this.eventManager.emit("removeEditor"),this.preview.$el.off("mousedown",$.proxy(this._toggleTask,this)),this.options=null,this.eventManager=null,this.commandManager=null,this.convertor=null,this.preview=null}},{key:"addHook",value:function(e,t){this.eventManager.removeEventHandler(e),this.eventManager.listen(e,t)}},{key:"isViewOnly",value:function(){return!0}},{key:"isMarkdownMode",value:function(){return!1}},{key:"isWysiwygMode",value:function(){return!1}}]),e}();e.exports=_},function(e,t){}]);