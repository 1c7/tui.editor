

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: wwPasteContentHelper.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="">
        <img src="img/toast-ui.png" width="100%" height="100%">
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Source: wwPasteContentHelper.js</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="CodeBlockManager.html">CodeBlockManager</a><div class="hidden" id="CodeBlockManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="CodeBlockManager.html#.getSharedInstance">getSharedInstance</a></li><li><a href="CodeBlockManager.html#createCodeBlockHtml">createCodeBlockHtml</a></li><li><a href="CodeBlockManager.html#replaceElements">replaceElements</a></li><li><a href="CodeBlockManager.html#setElementReplacer">setElementReplacer</a></li><li><a href="CodeBlockManager.html#updateCodeTextById">updateCodeTextById</a></li></ul></div></li><li><a href="Command.html">Command</a><div class="hidden" id="Command_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Command.html#.TYPE">TYPE</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Command.html#.factory">factory</a></li><li><a href="Command.html#getName">getName</a></li><li><a href="Command.html#getType">getType</a></li><li><a href="Command.html#isGlobalType">isGlobalType</a></li><li><a href="Command.html#isMDType">isMDType</a></li><li><a href="Command.html#isWWType">isWWType</a></li><li><a href="Command.html#setKeyMap">setKeyMap</a></li></ul></div></li><li><a href="CommandManager.html">CommandManager</a><div class="hidden" id="CommandManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="CommandManager.html#addCommand">addCommand</a></li><li><a href="CommandManager.html#exec">exec</a></li></ul></div></li><li><a href="ComponentManager.html">ComponentManager</a><div class="hidden" id="ComponentManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="ComponentManager.html#.CommandManager.command">CommandManager.command</a></li><li><a href="ComponentManager.html#addManager">addManager</a></li><li><a href="ComponentManager.html#getManager">getManager</a></li><li><a href="ComponentManager.html#removeManager">removeManager</a></li></ul></div></li><li><a href="Convertor.html">Convertor</a><div class="hidden" id="Convertor_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Convertor.html#.factory">factory</a></li><li><a href="Convertor.html#.getMarkdownHighlightRenderer">getMarkdownHighlightRenderer</a></li><li><a href="Convertor.html#toHTML">toHTML</a></li><li><a href="Convertor.html#toHTMLWithCodeHightlight">toHTMLWithCodeHightlight</a></li><li><a href="Convertor.html#toMarkdown">toMarkdown</a></li></ul></div></li><li><a href="EventManager.html">EventManager</a><div class="hidden" id="EventManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="EventManager.html#addEventType">addEventType</a></li><li><a href="EventManager.html#emit">emit</a></li><li><a href="EventManager.html#emitReduce">emitReduce</a></li><li><a href="EventManager.html#listen">listen</a></li><li><a href="EventManager.html#removeEventHandler">removeEventHandler</a></li></ul></div></li><li><a href="ExtManager.html">ExtManager</a><div class="hidden" id="ExtManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="ExtManager.html#applyExtension">applyExtension</a></li><li><a href="ExtManager.html#defineExtension">defineExtension</a></li></ul></div></li><li><a href="I18n.html">I18n</a><div class="hidden" id="I18n_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="I18n.html#get">get</a></li><li><a href="I18n.html#setCode">setCode</a></li><li><a href="I18n.html#setLang">setLang</a></li></ul></div></li><li><a href="ImportManager.html">ImportManager</a><div class="hidden" id="ImportManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="ImportManager.html#_decodeURL">_decodeURL</a></li></ul></div></li><li><a href="KeyMapper.html">KeyMapper</a><div class="hidden" id="KeyMapper_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="KeyMapper.html#.getSharedInstance">getSharedInstance</a></li><li><a href="KeyMapper.html#convert">convert</a></li></ul></div></li><li><a href="Layout.html">Layout</a><div class="hidden" id="Layout_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Layout.html#changePreviewStyle">changePreviewStyle</a></li><li><a href="Layout.html#getEditorEl">getEditorEl</a></li><li><a href="Layout.html#getMdEditorContainerEl">getMdEditorContainerEl</a></li><li><a href="Layout.html#getPreviewEl">getPreviewEl</a></li><li><a href="Layout.html#getWwEditorContainerEl">getWwEditorContainerEl</a></li><li><a href="Layout.html#hide">hide</a></li><li><a href="Layout.html#init">init</a></li><li><a href="Layout.html#remove">remove</a></li><li><a href="Layout.html#show">show</a></li><li><a href="Layout.html#switchToMarkdown">switchToMarkdown</a></li><li><a href="Layout.html#switchToWYSIWYG">switchToWYSIWYG</a></li></ul></div></li><li><a href="MarkdownEditor.html">MarkdownEditor</a><div class="hidden" id="MarkdownEditor_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="MarkdownEditor.html#.factory">factory</a></li><li><a href="MarkdownEditor.html#addWidget">addWidget</a></li><li><a href="MarkdownEditor.html#blur">blur</a></li><li><a href="MarkdownEditor.html#focus">focus</a></li><li><a href="MarkdownEditor.html#getCaretPosition">getCaretPosition</a></li><li><a href="MarkdownEditor.html#getCurrentRange">getCurrentRange</a></li><li><a href="MarkdownEditor.html#getEditor">getEditor</a></li><li><a href="MarkdownEditor.html#getRange">getRange</a></li><li><a href="MarkdownEditor.html#getTextObject">getTextObject</a></li><li><a href="MarkdownEditor.html#getValue">getValue</a></li><li><a href="MarkdownEditor.html#moveCursorToEnd">moveCursorToEnd</a></li><li><a href="MarkdownEditor.html#moveCursorToStart">moveCursorToStart</a></li><li><a href="MarkdownEditor.html#remove">remove</a></li><li><a href="MarkdownEditor.html#replaceRelativeOffset">replaceRelativeOffset</a></li><li><a href="MarkdownEditor.html#replaceSelection">replaceSelection</a></li><li><a href="MarkdownEditor.html#reset">reset</a></li><li><a href="MarkdownEditor.html#scrollTop">scrollTop</a></li><li><a href="MarkdownEditor.html#setHeight">setHeight</a></li><li><a href="MarkdownEditor.html#setValue">setValue</a></li></ul></div></li><li><a href="MarkerManager.html">MarkerManager</a><div class="hidden" id="MarkerManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="MarkerManager.html#_calculateEndDiff">_calculateEndDiff</a></li><li><a href="MarkerManager.html#_calculateStartDiff">_calculateStartDiff</a></li><li><a href="MarkerManager.html#_forEachChanges">_forEachChanges</a></li><li><a href="MarkerManager.html#_getUpdateMarkersWithDiffs">_getUpdateMarkersWithDiffs</a></li><li><a href="MarkerManager.html#_makeMarkerDiffs">_makeMarkerDiffs</a></li><li><a href="MarkerManager.html#resetContent">resetContent</a></li><li><a href="MarkerManager.html#updateMarkersByContent">updateMarkersByContent</a></li></ul></div></li><li><a href="MdListManager.html">MdListManager</a><div class="hidden" id="MdListManager_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="MdListManager.html#.this.name">this.name</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="MdListManager.html#appendBlankLineIfNeed">appendBlankLineIfNeed</a></li><li><a href="MdListManager.html#createSortedLineRange">createSortedLineRange</a></li><li><a href="MdListManager.html#expandLineRangeIfNeed">expandLineRangeIfNeed</a></li><li><a href="MdListManager.html#isListOrParagraph">isListOrParagraph</a></li><li><a href="MdListManager.html#replaceLineText">replaceLineText</a></li></ul></div></li><li><a href="Preview.html">Preview</a><div class="hidden" id="Preview_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Preview.html#isVisible">isVisible</a></li><li><a href="Preview.html#refresh">refresh</a></li><li><a href="Preview.html#render">render</a></li><li><a href="Preview.html#setHeight">setHeight</a></li></ul></div></li><li><a href="SectionManager.html">SectionManager</a><div class="hidden" id="SectionManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="SectionManager.html#_addNewSection">_addNewSection</a></li><li><a href="SectionManager.html#_doFollowedLinesHaveCodeBlockEnd">_doFollowedLinesHaveCodeBlockEnd</a></li><li><a href="SectionManager.html#_eachLineState">_eachLineState</a></li><li><a href="SectionManager.html#_getPreviewSections">_getPreviewSections</a></li><li><a href="SectionManager.html#_isAtxHeader">_isAtxHeader</a></li><li><a href="SectionManager.html#_isCodeBlockEnd">_isCodeBlockEnd</a></li><li><a href="SectionManager.html#_isCodeBlockStart">_isCodeBlockStart</a></li><li><a href="SectionManager.html#_isSeTextHeader">_isSeTextHeader</a></li><li><a href="SectionManager.html#_isTable">_isTable</a></li><li><a href="SectionManager.html#_isTableAligner">_isTableAligner</a></li><li><a href="SectionManager.html#_isTableCode">_isTableCode</a></li><li><a href="SectionManager.html#_makeSectionData">_makeSectionData</a></li><li><a href="SectionManager.html#_matchPreviewSectionsWithSectionlist">_matchPreviewSectionsWithSectionlist</a></li><li><a href="SectionManager.html#_updateCurrentSectionEnd">_updateCurrentSectionEnd</a></li><li><a href="SectionManager.html#getSectionList">getSectionList</a></li><li><a href="SectionManager.html#makeSectionList">makeSectionList</a></li><li><a href="SectionManager.html#sectionByLine">sectionByLine</a></li><li><a href="SectionManager.html#sectionMatch">sectionMatch</a></li></ul></div></li><li><a href="ToastUIEditor.html">ToastUIEditor</a><div class="hidden" id="ToastUIEditor_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ToastUIEditor.html#.i18n">i18n</a></li><li><a href="ToastUIEditor.html#.markdownItRenderer">markdownItRenderer</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="ToastUIEditor.html#.defineExtension">defineExtension</a></li><li><a href="ToastUIEditor.html#.factory">factory</a></li><li><a href="ToastUIEditor.html#.getInstances">getInstances</a></li><li><a href="ToastUIEditor.html#addHook">addHook</a></li><li><a href="ToastUIEditor.html#addWidget">addWidget</a></li><li><a href="ToastUIEditor.html#afterAddedCommand">afterAddedCommand</a></li><li><a href="ToastUIEditor.html#blur">blur</a></li><li><a href="ToastUIEditor.html#changeMode">changeMode</a></li><li><a href="ToastUIEditor.html#changePreviewStyle">changePreviewStyle</a></li><li><a href="ToastUIEditor.html#contentHeight">contentHeight</a></li><li><a href="ToastUIEditor.html#exec">exec</a></li><li><a href="ToastUIEditor.html#focus">focus</a></li><li><a href="ToastUIEditor.html#getCodeMirror">getCodeMirror</a></li><li><a href="ToastUIEditor.html#getCurrentModeEditor">getCurrentModeEditor</a></li><li><a href="ToastUIEditor.html#getCurrentPreviewStyle">getCurrentPreviewStyle</a></li><li><a href="ToastUIEditor.html#getHtml">getHtml</a></li><li><a href="ToastUIEditor.html#getMarkdown">getMarkdown</a></li><li><a href="ToastUIEditor.html#getRange">getRange</a></li><li><a href="ToastUIEditor.html#getSquire">getSquire</a></li><li><a href="ToastUIEditor.html#getTextObject">getTextObject</a></li><li><a href="ToastUIEditor.html#getUI">getUI</a></li><li><a href="ToastUIEditor.html#getValue">getValue</a></li><li><a href="ToastUIEditor.html#hide">hide</a></li><li><a href="ToastUIEditor.html#isMarkdownMode">isMarkdownMode</a></li><li><a href="ToastUIEditor.html#isViewOnly">isViewOnly</a></li><li><a href="ToastUIEditor.html#isWysiwygMode">isWysiwygMode</a></li><li><a href="ToastUIEditor.html#moveCursorToEnd">moveCursorToEnd</a></li><li><a href="ToastUIEditor.html#moveCursorToStart">moveCursorToStart</a></li><li><a href="ToastUIEditor.html#off">off</a></li><li><a href="ToastUIEditor.html#on">on</a></li><li><a href="ToastUIEditor.html#remove">remove</a></li><li><a href="ToastUIEditor.html#removeHook">removeHook</a></li><li><a href="ToastUIEditor.html#reset">reset</a></li><li><a href="ToastUIEditor.html#scrollTop">scrollTop</a></li><li><a href="ToastUIEditor.html#setHtml">setHtml</a></li><li><a href="ToastUIEditor.html#setMarkdown">setMarkdown</a></li><li><a href="ToastUIEditor.html#setUI">setUI</a></li><li><a href="ToastUIEditor.html#setValue">setValue</a></li><li><a href="ToastUIEditor.html#show">show</a></li></ul></div></li><li><a href="ToastUIEditorViewOnly.html">ToastUIEditorViewOnly</a><div class="hidden" id="ToastUIEditorViewOnly_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="ToastUIEditorViewOnly.html#addHook">addHook</a></li><li><a href="ToastUIEditorViewOnly.html#isMarkdownMode">isMarkdownMode</a></li><li><a href="ToastUIEditorViewOnly.html#isViewOnly">isViewOnly</a></li><li><a href="ToastUIEditorViewOnly.html#isWysiwygMode">isWysiwygMode</a></li><li><a href="ToastUIEditorViewOnly.html#off">off</a></li><li><a href="ToastUIEditorViewOnly.html#on">on</a></li><li><a href="ToastUIEditorViewOnly.html#remove">remove</a></li><li><a href="ToastUIEditorViewOnly.html#setMarkdown">setMarkdown</a></li><li><a href="ToastUIEditorViewOnly.html#setValue">setValue</a></li></ul></div></li><li><a href="WwClipboardManager.html">WwClipboardManager</a><div class="hidden" id="WwClipboardManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="WwClipboardManager.html#init">init</a></li></ul></div></li><li><a href="WwCodeBlockManager.html">WwCodeBlockManager</a><div class="hidden" id="WwCodeBlockManager_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="WwCodeBlockManager.html#.this.name">this.name</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="WwCodeBlockManager.html#convertToCodeblock">convertToCodeblock</a></li><li><a href="WwCodeBlockManager.html#isInCodeBlock">isInCodeBlock</a></li><li><a href="WwCodeBlockManager.html#prepareToPasteOnCodeblock">prepareToPasteOnCodeblock</a></li></ul></div></li><li><a href="WwHeadingManager.html">WwHeadingManager</a><div class="hidden" id="WwHeadingManager_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="WwHeadingManager.html#.this.name">this.name</a></li></ul></div></li><li><a href="WwHrManager.html">WwHrManager</a><div class="hidden" id="WwHrManager_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="WwHrManager.html#.this.name">this.name</a></li></ul></div></li><li><a href="WwListManager.html">WwListManager</a><div class="hidden" id="WwListManager_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="WwListManager.html#.this.name">this.name</a></li></ul></div></li><li><a href="WwMergedTableManager.html">WwMergedTableManager</a><div class="hidden" id="WwMergedTableManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="WwMergedTableManager.html#prepareToTableCellStuffing">prepareToTableCellStuffing</a></li><li><a href="WwMergedTableManager.html#tableCellAppendAidForTableElement">tableCellAppendAidForTableElement</a></li></ul></div></li><li><a href="WwMergedTableSelectionManager.html">WwMergedTableSelectionManager</a><div class="hidden" id="WwMergedTableSelectionManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="WwMergedTableSelectionManager.html#hasSelectedBothThAndTd">hasSelectedBothThAndTd</a></li><li><a href="WwMergedTableSelectionManager.html#highlightTableCellsBy">highlightTableCellsBy</a></li><li><a href="WwMergedTableSelectionManager.html#setTableSelectionTimerIfNeed">setTableSelectionTimerIfNeed</a></li><li><a href="WwMergedTableSelectionManager.html#styleToSelectedCells">styleToSelectedCells</a></li></ul></div></li><li><a href="WwPasteContentHelper.html">WwPasteContentHelper</a><div class="hidden" id="WwPasteContentHelper_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="WwPasteContentHelper.html#preparePaste">preparePaste</a></li></ul></div></li><li><a href="WwPManager.html">WwPManager</a><div class="hidden" id="WwPManager_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="WwPManager.html#.this.name">this.name</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="WwPManager.html#_splitPtagContentLines">_splitPtagContentLines</a></li></ul></div></li><li><a href="WwTableManager.html">WwTableManager</a><div class="hidden" id="WwTableManager_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="WwTableManager.html#.this.name">this.name</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="WwTableManager.html#_changeSelectionToTargetCell">_changeSelectionToTargetCell</a></li><li><a href="WwTableManager.html#_onPaste">_onPaste</a></li><li><a href="WwTableManager.html#destroy">destroy</a></li><li><a href="WwTableManager.html#getTableIDClassName">getTableIDClassName</a></li><li><a href="WwTableManager.html#isInTable">isInTable</a></li><li><a href="WwTableManager.html#isNonTextDeleting">isNonTextDeleting</a></li><li><a href="WwTableManager.html#prepareToPasteOnTable">prepareToPasteOnTable</a></li><li><a href="WwTableManager.html#prepareToTableCellStuffing">prepareToTableCellStuffing</a></li><li><a href="WwTableManager.html#resetLastCellNode">resetLastCellNode</a></li><li><a href="WwTableManager.html#setLastCellNode">setLastCellNode</a></li><li><a href="WwTableManager.html#tableCellAppendAidForTableElement">tableCellAppendAidForTableElement</a></li><li><a href="WwTableManager.html#wrapDanglingTableCellsIntoTrIfNeed">wrapDanglingTableCellsIntoTrIfNeed</a></li><li><a href="WwTableManager.html#wrapTheadAndTbodyIntoTableIfNeed">wrapTheadAndTbodyIntoTableIfNeed</a></li><li><a href="WwTableManager.html#wrapTrsIntoTbodyIfNeed">wrapTrsIntoTbodyIfNeed</a></li></ul></div></li><li><a href="WwTableSelectionManager.html">WwTableSelectionManager</a><div class="hidden" id="WwTableSelectionManager_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="WwTableSelectionManager.html#.this.name">this.name</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="WwTableSelectionManager.html#destroy">destroy</a></li><li><a href="WwTableSelectionManager.html#getSelectionRangeFromTable">getSelectionRangeFromTable</a></li><li><a href="WwTableSelectionManager.html#highlightTableCellsBy">highlightTableCellsBy</a></li><li><a href="WwTableSelectionManager.html#removeClassAttrbuteFromAllCellsIfNeed">removeClassAttrbuteFromAllCellsIfNeed</a></li><li><a href="WwTableSelectionManager.html#setTableSelectionTimerIfNeed">setTableSelectionTimerIfNeed</a></li><li><a href="WwTableSelectionManager.html#styleToSelectedCells">styleToSelectedCells</a></li></ul></div></li><li><a href="WwTaskManager.html">WwTaskManager</a><div class="hidden" id="WwTaskManager_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="WwTaskManager.html#.this.name">this.name</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="WwTaskManager.html#formatTask">formatTask</a></li><li><a href="WwTaskManager.html#isInTaskList">isInTaskList</a></li><li><a href="WwTaskManager.html#unformatTask">unformatTask</a></li></ul></div></li><li><a href="WwTextObject.html">WwTextObject</a><div class="hidden" id="WwTextObject_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="WwTextObject.html#deleteContent">deleteContent</a></li><li><a href="WwTextObject.html#expandEndOffset">expandEndOffset</a></li><li><a href="WwTextObject.html#expandStartOffset">expandStartOffset</a></li><li><a href="WwTextObject.html#getTextContent">getTextContent</a></li><li><a href="WwTextObject.html#peekStartBeforeOffset">peekStartBeforeOffset</a></li><li><a href="WwTextObject.html#replaceContent">replaceContent</a></li><li><a href="WwTextObject.html#setEndBeforeRange">setEndBeforeRange</a></li><li><a href="WwTextObject.html#setRange">setRange</a></li></ul></div></li><li><a href="WysiwygEditor.html">WysiwygEditor</a><div class="hidden" id="WysiwygEditor_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="WysiwygEditor.html#.factory">factory</a></li><li><a href="WysiwygEditor.html#.MarkdownEditor#init">MarkdownEditor#init</a></li><li><a href="WysiwygEditor.html#addKeyEventHandler">addKeyEventHandler</a></li><li><a href="WysiwygEditor.html#addWidget">addWidget</a></li><li><a href="WysiwygEditor.html#blur">blur</a></li><li><a href="WysiwygEditor.html#breakToNewDefaultBlock">breakToNewDefaultBlock</a></li><li><a href="WysiwygEditor.html#changeBlockFormatTo">changeBlockFormatTo</a></li><li><a href="WysiwygEditor.html#findTextNodeFilter">findTextNodeFilter</a></li><li><a href="WysiwygEditor.html#focus">focus</a></li><li><a href="WysiwygEditor.html#get$Body">get$Body</a></li><li><a href="WysiwygEditor.html#getEditor">getEditor</a></li><li><a href="WysiwygEditor.html#getRange">getRange</a></li><li><a href="WysiwygEditor.html#getTextObject">getTextObject</a></li><li><a href="WysiwygEditor.html#getValue">getValue</a></li><li><a href="WysiwygEditor.html#hasFormatWithRx">hasFormatWithRx</a></li><li><a href="WysiwygEditor.html#init">init</a></li><li><a href="WysiwygEditor.html#makeEmptyBlockCurrentSelection">makeEmptyBlockCurrentSelection</a></li><li><a href="WysiwygEditor.html#moveCursorToEnd">moveCursorToEnd</a></li><li><a href="WysiwygEditor.html#moveCursorToStart">moveCursorToStart</a></li><li><a href="WysiwygEditor.html#readySilentChange">readySilentChange</a></li><li><a href="WysiwygEditor.html#remove">remove</a></li><li><a href="WysiwygEditor.html#removeKeyEventHandler">removeKeyEventHandler</a></li><li><a href="WysiwygEditor.html#replaceContentText">replaceContentText</a></li><li><a href="WysiwygEditor.html#replaceRelativeOffset">replaceRelativeOffset</a></li><li><a href="WysiwygEditor.html#replaceSelection">replaceSelection</a></li><li><a href="WysiwygEditor.html#reset">reset</a></li><li><a href="WysiwygEditor.html#restoreSavedSelection">restoreSavedSelection</a></li><li><a href="WysiwygEditor.html#saveSelection">saveSelection</a></li><li><a href="WysiwygEditor.html#scrollTop">scrollTop</a></li><li><a href="WysiwygEditor.html#setHeight">setHeight</a></li><li><a href="WysiwygEditor.html#setValue">setValue</a></li><li><a href="WysiwygEditor.html#unwrapBlockTag">unwrapBlockTag</a></li></ul></div></li><li><a href="WysiwygMarkerHelper.html">WysiwygMarkerHelper</a><div class="hidden" id="WysiwygMarkerHelper_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="WysiwygMarkerHelper.html#_extendRangeToTextNodeIfHasNone">_extendRangeToTextNodeIfHasNone</a></li><li><a href="WysiwygMarkerHelper.html#_findOffsetNode">_findOffsetNode</a></li><li><a href="WysiwygMarkerHelper.html#_getExtraInfoOfRange">_getExtraInfoOfRange</a></li><li><a href="WysiwygMarkerHelper.html#clearSelect">clearSelect</a></li><li><a href="WysiwygMarkerHelper.html#getMarkerInfoOfCurrentSelection">getMarkerInfoOfCurrentSelection</a></li><li><a href="WysiwygMarkerHelper.html#getTextContent">getTextContent</a></li><li><a href="WysiwygMarkerHelper.html#selectOffsetRange">selectOffsetRange</a></li><li><a href="WysiwygMarkerHelper.html#updateMarkerWithExtraInfo">updateMarkerWithExtraInfo</a></li></ul></div></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview Implements WwPasteContentHelper
 * @author Sungho Kim(sungho-kim@nhnent.com) FE Development Team/NHN Ent.
 */

import domUtils from './domUtils';
import htmlSanitizer from './htmlSanitizer';

const util = tui.util;

/**
 * WwPasteContentHelper
 * @exports WwPasteContentHelper
 * @class WwPasteContentHelper
 * @constructor
 * @param {WysiwygEditor} wwe wysiwygEditor instance
 */
class WwPasteContentHelper {
    constructor(wwe) {
        this.wwe = wwe;
    }

    /**
     * Process paste data before paste
     * @api
     * @memberOf WwPasteContentHelper
     * @param {object} pasteData Pasting data
     */
    preparePaste(pasteData) {
        const range = this.wwe.getEditor().getSelection().cloneRange();
        const codeblockManager = this.wwe.componentManager.getManager('codeblock');
        const tableManager = this.wwe.componentManager.getManager('table');
        let firstBlockIsTaken = false;
        let newFragment = this.wwe.getEditor().getDocument().createDocumentFragment();
        let nodeName, node, isPastingList;

        pasteData.fragment = this._pasteFirstAid(pasteData.fragment);

        const childNodes = util.toArray(pasteData.fragment.childNodes);

        // prepare to paste as inline of first node if possible
        // 앞부분의 인라인으로 붙일수 있느부분은 인라인으로 붙을수 있도록 처리
        if (childNodes.length &amp;&amp; childNodes[0].tagName === 'DIV') {
            $(newFragment).append(this._unwrapFragmentFirstChildForPasteAsInline(childNodes[0]));
            childNodes.shift();
        }

        while (childNodes.length) {
            node = childNodes[0];
            nodeName = domUtils.getNodeName(node);
            isPastingList = nodeName === 'LI' || nodeName === 'UL' || nodeName === 'OL';

            if (codeblockManager.isInCodeBlock(range)) {
                newFragment.appendChild(codeblockManager.prepareToPasteOnCodeblock(childNodes));
            } else if (tableManager.isInTable(range)) {
                newFragment = tableManager.prepareToPasteOnTable(pasteData, node);
                childNodes.shift();
            } else if (isPastingList) {
                newFragment.appendChild(this._prepareToPasteList(childNodes, pasteData.rangeInfo, firstBlockIsTaken));
                // 첫번째 현재위치와 병합될 가능성이있는 컨텐츠가 만들어진경우는 이후 위치에 대한 정보가 필요없다
                firstBlockIsTaken = true;
            } else {
                newFragment.appendChild(childNodes.shift());
            }
        }

        pasteData.fragment = newFragment;
    }

    /**
     * Wrap orphan node(inline, text) with div element
     * @param {DocumentFragment} fragment - Fragment of paste data
     * @memberOf WwPasteContentHelper
     * @returns {DocumentFragment}
     * @private
     */
    _wrapOrphanNodeWithDiv(fragment) {
        const newFrag = document.createDocumentFragment();
        const array = util.toArray(fragment.childNodes);
        let currentDiv;

        util.forEachArray(array, node => {
            const isTextNode = node.nodeType === 3;
            /* eslint-disable max-len */
            const isInlineNode = /^(SPAN|A|CODE|EM|I|STRONG|B|S|ABBR|ACRONYM|CITE|DFN|KBD|SAMP|VAR|BDO|Q|SUB|SUP)$/ig.test(node.tagName);
            /* eslint-enable max-len */

            if (isTextNode || isInlineNode) {
                if (!currentDiv) {
                    currentDiv = document.createElement('div');
                    newFrag.appendChild(currentDiv);
                }

                currentDiv.appendChild(node);
            } else {
                if (currentDiv &amp;&amp; currentDiv.lastChild.tagName !== 'BR') {
                    currentDiv.appendChild($('&lt;br/>')[0]);
                }

                currentDiv = null;
                newFrag.appendChild(node);
            }
        });

        return newFrag;
    }

    /**
     * Processing paste data after paste
     * @param {DocumentFragment} fragment Pasting data
     * @memberOf WwPasteContentHelper
     * @returns {DocumentFragment}
     * @private
     */
    _pasteFirstAid(fragment) {
        const blockTags = 'div, section, article, aside, nav, menus, p';

        fragment = htmlSanitizer(fragment);

        $(fragment).find('*').each((i, node) => {
            this._removeStyles(node);
        });

        this._unwrapIfNonBlockElementHasBr(fragment);
        this._unwrapNestedBlocks(fragment, blockTags);

        this._removeUnnecessaryBlocks(fragment, blockTags);
        this._removeStyles(fragment);

        fragment = this._wrapOrphanNodeWithDiv(fragment);

        this._preElementAid(fragment);

        this._tableElementAid(fragment);

        $(fragment).children('br').remove();

        return fragment;
    }

    /**
     * PRE tag formatting
     * @memberOf WwPasteContentHelper
     * @private
     * @param {DocumentFragment} nodes Pasting DocumentFragment
     */
    _preElementAid(nodes) {
        const codeblockManager = this.wwe.componentManager.getManager('codeblock');

        codeblockManager.splitCodeblockToEachLine(nodes);
    }

    /**
     * Unwrap span children of document fragment with div element
     * @param {DocumentFragment} fragment - Fragment of paste data
     * @memberOf WwPasteContentHelper
     * @private
     */
    _unwrapIfNonBlockElementHasBr(fragment) {
        const nonBlockElements = $(fragment).find('span, a, b, em, i, s');

        nonBlockElements.each((i, node) => {
            const brChildren = $(node).children('br');

            if (brChildren.length &amp;&amp; node.nodeName !== 'LI' &amp;&amp; node.nodeName !== 'UL') {
                brChildren.eq(0).unwrap();
            }
        });
    }

    /**
     * Unwrap nested block elements
     * @param {DocumentFragment} fragment - Fragment of paste data
     * @param {string} blockTags - Tag names of block tag
     * @private
     */
    _unwrapNestedBlocks(fragment, blockTags) {
        const leafElements = $(fragment).find(':not(:has(*))').not('b,s,i,em,code,span');

        leafElements.each((i, node) => {
            let leafElement = node.nodeName === 'BR' ? $(node.parentNode) : $(node);
            let parent;

            while (leafElement.parents(blockTags).length) {
                parent = leafElement.parent(blockTags);

                if (parent.length) {
                    leafElement.unwrap();
                } else {
                    leafElement = leafElement.parent();
                }
            }
        });
    }

    /**
     * Remove unnecessary block element in pasting data
     * @param {DocumentFragment} fragment Pasting DocumentFragment
     * @param {string} blockTags - Tag names of block tag
     * @memberOf WwPasteContentHelper
     * @private
     */
    _removeUnnecessaryBlocks(fragment, blockTags) {
        $(fragment).find(blockTags).each((index, blockElement) => {
            const $blockElement = $(blockElement);
            const tagName = blockElement.tagName;
            const isDivElement = tagName === 'DIV';
            const isInListItem = $blockElement.parent('li').length !== 0;
            const isInBlockquote = $blockElement.parent('blockquote').length !== 0;
            const hasBlockChildElement = $blockElement.children(blockTags).length;

            if (isDivElement
                &amp;&amp; (isInListItem || isInBlockquote || !hasBlockChildElement)
            ) {
                return;
            }

            $blockElement.replaceWith($blockElement.html());
        });
    }

    /**
     * Remove inline style
     * @param {Node} node Node for remove style attribute
     * @memberOf WwPasteContentHelper
     * @private
     */
    _removeStyles(node) {
        const $node = $(node);
        let colorValue;

        if (domUtils.getNodeName($node[0]) !== 'SPAN') {
            $node.removeAttr('style');
        } else {
            // Most browser return computed color value even if without style attribute
            if ($node.attr('style')) {
                colorValue = $node.css('color');
            }

            $node.removeAttr('style');

            if (colorValue) {
                $node.css('color', colorValue);
            } else {
                $node.contents().unwrap();
            }
        }
    }

    /**
     * Processing before paste list
     * @param {Array.&lt;HTMLElement>} nodes Pasting data
     * @param {object} rangeInfo Range information
     * @param {boolean} firstBlockIsTaken Whether first block element taken or not
     * @returns {DocumentFragment}
     * @memberOf WwPasteContentHelper
     * @private
     */
    _prepareToPasteList(nodes, rangeInfo, firstBlockIsTaken) {
        let nodeName = domUtils.getNodeName(nodes[0]);
        let node = nodes.shift();
        const newFragment = this.wwe.getEditor().getDocument().createDocumentFragment();

        // IE에서는 LI-UL 구조에서 UL이 전체가 선택되었는데 LI를 포함하지 않고 UL만 넘어올때가 있다.
        if (nodeName !== 'LI' &amp;&amp; nodes.length &amp;&amp; nodes[0].tagName === 'LI') {
            nodeName = 'LI';

            node = this._makeNodeAndAppend({
                tagName: nodeName
            }, node);
        }

        // UL과 OL이고 리스트에 paste하는경우 뎊스처리
        if (nodeName === 'OL' || nodeName === 'UL') {
            // 페이스트 데이터의 첫번째 블럭요소가 이미 만들어졌다면 커서의 위치에 대한 대응은 하지 않는다.
            if (!firstBlockIsTaken &amp;&amp; this.wwe.getEditor().hasFormat('LI')) {
                $(newFragment).append(this._wrapCurrentFormat(node));
            } else {
                $(newFragment).append(node);
            }
        } else if (nodeName === 'LI') {
            // 리스트 그룹처리
            const listGroup = this.wwe.getEditor().getDocument().createDocumentFragment();
            listGroup.appendChild(node);

            while (nodes.length &amp;&amp; nodes[0].tagName === 'LI') {
                listGroup.appendChild(nodes.shift());
            }

            // 리스트에 붙는경우 뎊스 연결
            // 페이스트 데이터의 첫번째 블럭요소가 이미 만들어졌다면 커서의 위치에 대한 대응은 하지 않는다.
            if (!firstBlockIsTaken &amp;&amp; this.wwe.getEditor().hasFormat('LI')) {
                $(newFragment).append(this._wrapCurrentFormat(listGroup));
                // 카피할당시의 정보가 있다면 해당 리스트로 만듬
            } else if (rangeInfo
                &amp;&amp; (rangeInfo.commonAncestorName === 'UL' || rangeInfo.commonAncestorName === 'OL')) {
                $(newFragment).append(this._makeNodeAndAppend({
                    tagName: rangeInfo.commonAncestorName
                }, listGroup));
                // 외부에서온 리스트
            } else {
                $(newFragment).append(this._makeNodeAndAppend({
                    tagName: 'UL'
                }, listGroup));
            }
        }

        return newFragment;
    }

    /**
     * Unwrap fragment first child for pasting node inline
     * @memberOf WwPasteContentHelper
     * @private
     * @param {Node} node Pasting DocumentFragment
     * @returns {NodeList}
     */
    _unwrapFragmentFirstChildForPasteAsInline(node) {
        $(node).find('br').remove();

        return node.childNodes;
    }

    /**
     * Wrap nodes with current format
     * @param {DocumentFragment} nodes P
     * @returns {HTMLElement}
     * @private
     */
    _wrapCurrentFormat(nodes) {
        let currentTagName;

        // 붙여질 뎊스에 맞게 확장
        this._eachCurrentPath(path => {
            if (path.tagName !== 'DIV') {
                // 프레그먼트 노드인경우와 한번이상 감싸진 노드임
                if (domUtils.isElemNode(nodes)) {
                    currentTagName = nodes.tagName;
                } else {
                    currentTagName = nodes.firstChild.tagName;
                }

                if (path.tagName !== currentTagName) {
                    nodes = this._makeNodeAndAppend(path, nodes);
                }
            }
        });

        return nodes;
    }

    _eachCurrentPath(iteratee) {
        const paths = domUtils.getPath(this.wwe.getEditor().getSelection().startContainer, this.wwe.get$Body()[0]);

        for (let i = paths.length - 1; i > -1; i -= 1) {
            iteratee(paths[i]);
        }
    }

    /** _makeNodeAndAppend
     * make node and append their own children
     * @param {HTMLElement} pathInfo HTMLElement to make
     * @param {HTMLElement} content Nodes to append
     * @returns {HTMLElement} node
     * @memberOf WwPasteContentHelper
     * @private
     */
    _makeNodeAndAppend(pathInfo, content) {
        const node = $(`&lt;${pathInfo.tagName}/>`);

        node.append(content);

        if (pathInfo.id) {
            node.attr('id', pathInfo.id);
        }

        if (pathInfo.className) {
            node.addClass(pathInfo.className);
        }

        return node[0];
    }

    /**
     * Pasting table element pre-process
     * @param {DocumentFragment} fragment pasteData's fragment
     * @memberOf WwPasteContentHelper
     * @private
     */
    _tableElementAid(fragment) {
        this._completeTableIfNeed(fragment);
        this._updateTableIDClassName(fragment);
    }

    /**
     * Complete and append table to fragment
     * @param {DocumentFragment} fragment Copied data
     * @private
     */
    _completeTableIfNeed(fragment) {
        const tableManager = this.wwe.componentManager.getManager('table');
        const wrapperTr = tableManager.wrapDanglingTableCellsIntoTrIfNeed(fragment);

        if (wrapperTr) {
            $(fragment).append(wrapperTr);
        }

        const wrapperTbody = tableManager.wrapTrsIntoTbodyIfNeed(fragment);

        if (wrapperTbody) {
            $(fragment).append(wrapperTbody);
        }

        const wrapperTable = tableManager.wrapTheadAndTbodyIntoTableIfNeed(fragment);

        if (wrapperTable) {
            $(fragment).append(wrapperTable);
        }
    }

    /**
     * Update table ID class name in fragment
     * @param {DocumentFragment} fragment Copied data
     * @private
     */
    _updateTableIDClassName(fragment) {
        const tableManager = this.wwe.componentManager.getManager('table');

        $(fragment).find('table').each((index, table) => {
            $(table).removeClass((idx, className) =>
                className.replace(/.*\s*(te-content-table-\d+)\s*.*/, '$1'));
        });

        $(fragment).find('table').each((index, table) => {
            $(table).addClass(tableManager.getTableIDClassName());
        });
    }
}

module.exports = WwPasteContentHelper;
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="img/toast-ui.png" style="">
    <div class="footer-text">NHN Entertainment. Frontend Development Lab</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var element = document.getElementById(id); // do not use jquery selector

        $(element).removeClass('hidden');
        showLnbApi();
    </script>

</body>
</html>
